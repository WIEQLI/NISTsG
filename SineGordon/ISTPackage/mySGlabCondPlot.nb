(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    299786,       7344]
NotebookOptionsPosition[    297012,       7245]
NotebookOutlinePosition[    297439,       7263]
CellTagsIndexPosition[    297396,       7260]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Copyright", " ", "2013", " ", "Thomas", " ", "Trogdon"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "software", " ", "is", " ", "distributed", " ", "under", " ", 
    "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", "General", 
    " ", "Public", " ", "License"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"add", " ", "shift", " ", "later"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.677418668213238*^9, 3.677418679422053*^9}}],

Cell[CellGroupData[{

Cell["Documentation", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.513708165818142*^9, 3.51370816752608*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<RiemannHilbert`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HillSG", "::", "usage"}], "=", 
   "\"\<HillSG[q,n] gives the eigenvalues of the modified Zakharov-Shabat \
scattering (including continuous spectrum) problem with n Fourier modes using \
Hill's method.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LocatePolesSG", "::", "usage"}], "=", 
   "\"\<LocatePoles[q,n] gives the true eigenvalues of the modified \
Zakharov-Shabat scattering problem.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SG", "::", "usage"}], "=", 
   "\"\<mKdV[i][x,t] = {out,\[CapitalPhi],rhp1,rhp2,timestring} where out is \
the solution of mKdV, \[CapitalPhi] is the solution of the Riemann-Hilbert \
problem, rhp1 and rhp2 are the Riemann-Hilbert problems and timestring is the \
string of computation times.  This is done using the deformation in Region i.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SGAuto", "::", "usage"}], "=", 
   "\"\<NLSAuto[x,t] returns the solution of the mKdV equation with \
deformation selected automagically.  Many things must be initialized.  Sample \
code:\n\n\tq[x_]:=.1 Exp[-x^2+I x];\[IndentingNewLine]Defocusing[];\n\t\
H=ScatteringMatrixFinitemKdV[q,50,6];\[IndentingNewLine]aa//Clear;bb//Clear;\
\[IndentingNewLine]aa[k_]:=aa[k]=H[k][[1,1]];\[IndentingNewLine]bb[k_]:=bb[k]=\
H[k][[2,1]];\n\t\
SetParams[.6,.1,10.^(-9),15,30];\[IndentingNewLine]h[k_]:=3/(1+Abs[k/2+1/3.2]^\
8);\[IndentingNewLine]Setrsamp[h];\[IndentingNewLine]Settimeflag[False];\
\[IndentingNewLine]\[Nu]=Getnu[];\[IndentingNewLine]\[Rho][k_]:=bb[k]/aa[k];\n\
\tup=I(\[Nu]+.0001);m=40;el=8;\[IndentingNewLine]f={Fun[\[Rho],Line[{-el,0}-\
up],m],Fun[\[Rho],Line[{0,el}-up],m],Fun[\[Rho],Line[{el,0}+up],m],Fun[\[Rho],\
Line[{0,-el}+up],m]};\n\n\t\
up=I(\[Nu]+.0001);m=40;el=8;\[IndentingNewLine]f={Fun[\[Rho],Line[{-el,0}-up],\
m],Fun[\[Rho],Line[{0,el}-up],m],Fun[\[Rho],Line[{el,0}+up],m],Fun[\[Rho],\
Line[{0,-el}+up],m]};\n\
SetScatteringData[aa,bb,m\[Rho],LocatePoles[q,40]]\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetScatteringData", "::", "usage"}], "=", 
   "\"\<SetScatteringData[a,b,\[Rho],poles] or \
SetScatteringData[a,b,\[Rho],poles,normingConstants] sets the scattering data \
for the mKdV equation\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetParams", "::", "usage"}], "=", 
   "\"\<SetParams[\[Nu],rad,globalTol,smallN,bigN] sets the parameters for \
the rest of the code:\n\t\[Nu]: half of width of strip of analyticity\n\trad: \
radius of soliton contours\n\tglobalTol: contour truncation tolerance\n\t\
smallN: small number of collocation points\n\tbigN: big number of collocation \
points\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetScatteringData", "::", "usage"}], "=", 
   "\"\<GetScatteringData[] = {\[Rho],poles,normingConstants}\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScatteringMatrixFiniteSG", "::", "usage"}], "=", 
   "\"\<ScatteringMatrixFinitemKdV[q,n,L] returns a function f[w] that \
produces an approximation of the scattering matrix at w. The parameter n \
indicates the number of collocation points and L sets the problem on [-L,L]\n\
Sample code:\n\tq[x_]:=.1 Exp[-x^2+I x];\[IndentingNewLine]Defocusing[];\n\t\
H=ScatteringMatrixFinitemKdV[q,50,6];\[IndentingNewLine]aa//Clear;bb//Clear;\
\[IndentingNewLine]aa[k_]:=aa[k]=H[k][[1,1]];\[IndentingNewLine]bb[k_]:=bb[k]=\
H[k][[2,1]];\n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Getnu", "::", "usage"}], "=", "\"\<Getnu[] returns \[Nu]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Setrsamp", "::", "usage"}], "=", 
   "\"\<Setrsamp[h] sets a function that should be chosen so that that \
|\[Rho]| < h\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timestring", "::", "usage"}], "=", 
   "\"\<A string updated by mKdV[i][x,t]\n(x,t) 1) Construct: --time to \
construct rhp1-- 1) Solve: --time to solve rhp1-- 2) Construct: --time to \
construct rhp2-- 2) Solve: --time to solve rhp2--\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Settimeflag", "::", "usage"}], "=", 
   "\"\<Settimeflag[bool] bool = True forces timestring to be printed each \
time mKdV[i][x,t] is called\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"startift", ";"}], "\[IndentingNewLine]", 
 RowBox[{"domainOutput", ";", "domainOutput2", ";"}], "\[IndentingNewLine]", 
 RowBox[{"SmallTimeContour", ";", "test2", ";", "test1", ";", "Modk0", ";", 
  "test3", ";", "test4", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ift1", ";", "ift2", ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalPhi]t", ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalPhi]tin", ";"}], "\[IndentingNewLine]", 
 RowBox[{"dom", ";"}], "\[IndentingNewLine]", 
 RowBox[{"J", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jadapt", ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "need", " ", "to", " ", "be", " ", "careful", " ", "about", " ", "the", 
    " ", "visibility", " ", "of", " ", "the", " ", "local", " ", 
    "variables"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"L", ";", "U", ";", "G", ";", "Q", ";", "Qn", ";", "M", ";", "P", 
  ";", "Msamp", ";", "Psamp", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grhp1", ";", "Grhp2", ";", "illlhs", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Gsamp", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.5137081968140993`*^9, 3.513708220106812*^9}, {
   3.513708251598336*^9, 3.513708260607749*^9}, {3.513709188920638*^9, 
   3.513709189830554*^9}, {3.5137102470949373`*^9, 3.513710248122636*^9}, {
   3.513710327213766*^9, 3.513710327375476*^9}, {3.5137107005416193`*^9, 
   3.513710704633794*^9}, {3.513892211328*^9, 3.513892244064*^9}, {
   3.513944038153119*^9, 3.5139440504772377`*^9}, {3.51490865283358*^9, 
   3.514908688869083*^9}, {3.5149088447367496`*^9, 3.514908847957034*^9}, {
   3.514908890493555*^9, 3.5149088915294123`*^9}, {3.514912537924096*^9, 
   3.514912538602947*^9}, 3.514912651568637*^9, {3.514913420363991*^9, 
   3.514913422351489*^9}, {3.514915238203745*^9, 3.514915240325727*^9}, {
   3.5149165696337*^9, 3.5149165710458717`*^9}, {3.514916828081748*^9, 
   3.5149168303085814`*^9}, {3.51492264908776*^9, 3.5149226496893663`*^9}, {
   3.514923459235902*^9, 3.514923473879924*^9}, {3.514923609606861*^9, 
   3.5149236678379297`*^9}, 3.5149237785404778`*^9, {3.5149239632762337`*^9, 
   3.514923985264545*^9}, 3.514924035992598*^9, {3.5150107064700003`*^9, 
   3.51501070749*^9}, {3.515010820084*^9, 3.515010822774*^9}, {
   3.515011739966*^9, 3.5150117447060003`*^9}, {3.515011811398*^9, 
   3.515011814668*^9}, 3.515016621426*^9, {3.515155006646846*^9, 
   3.515155012398736*^9}, {3.515161405388542*^9, 3.5151614071047297`*^9}, {
   3.515161506975882*^9, 3.515161507859984*^9}, {3.515162979110601*^9, 
   3.51516298439431*^9}, {3.515163681303184*^9, 3.5151636836334467`*^9}, {
   3.5151639040428743`*^9, 3.515163905490437*^9}, {3.515164066077634*^9, 
   3.5151640679776783`*^9}, {3.515182527641205*^9, 3.5151825295557623`*^9}, {
   3.5151898348264*^9, 3.5151898365736*^9}, {3.5151898668844*^9, 
   3.5151898686628*^9}, {3.515865595644541*^9, 3.515865599028973*^9}, {
   3.516018665879665*^9, 3.516018669923935*^9}, {3.516019454499804*^9, 
   3.516019457143765*^9}, {3.5160203425168753`*^9, 3.516020344083581*^9}, {
   3.516029273628706*^9, 3.516029277905128*^9}, {3.516029836359334*^9, 
   3.516029839868938*^9}, {3.51603168179848*^9, 3.516031684249277*^9}, {
   3.5160317359840117`*^9, 3.5160317372417727`*^9}, {3.516031839641303*^9, 
   3.516031839825748*^9}, {3.51604593957542*^9, 3.5160459415743923`*^9}, {
   3.5160491405591393`*^9, 3.516049143223133*^9}, {3.516049475447588*^9, 
   3.5160494773697643`*^9}, {3.516049789077999*^9, 3.516049790980497*^9}, {
   3.5161107536323442`*^9, 3.516110755122838*^9}, {3.5163721439439573`*^9, 
   3.5163721529521523`*^9}, {3.516386237320636*^9, 3.51638624850243*^9}, {
   3.5163862792664013`*^9, 3.5163862795321913`*^9}, {3.516386360236644*^9, 
   3.516386376811532*^9}, {3.516397335101952*^9, 3.516397337025401*^9}, {
   3.516397704562858*^9, 3.516397704765292*^9}, {3.516407718106127*^9, 
   3.516407720463643*^9}, {3.516410444818138*^9, 3.516410447464739*^9}, {
   3.516410875117381*^9, 3.516410876217999*^9}, {3.516410944587029*^9, 
   3.5164109483536577`*^9}, {3.516461126501289*^9, 3.5164611299490423`*^9}, {
   3.516461294707374*^9, 3.516461297166636*^9}, {3.516461327659837*^9, 
   3.516461327740819*^9}, {3.516463561809222*^9, 3.516463565124407*^9}, {
   3.516476398141786*^9, 3.516476398874007*^9}, {3.5164766625639257`*^9, 
   3.516476665579368*^9}, {3.5164793645522947`*^9, 3.5164793676290827`*^9}, {
   3.516479604034827*^9, 3.5164796054708357`*^9}, {3.516479833783655*^9, 
   3.5164798356595087`*^9}, 3.516493622096712*^9, 3.517748695954481*^9, {
   3.517774143133275*^9, 3.5177741451763573`*^9}, {3.5178396880058126`*^9, 
   3.517839689202875*^9}, {3.517858591597598*^9, 3.5178585973752937`*^9}, {
   3.5182917712009277`*^9, 3.518291774979272*^9}, {3.518375651840969*^9, 
   3.518375655792688*^9}, {3.518450285472134*^9, 3.518450290187779*^9}, {
   3.518450400407465*^9, 3.518450401236301*^9}, {3.51845107524128*^9, 
   3.518451076733898*^9}, {3.518699044664328*^9, 3.518699047060379*^9}, {
   3.518699684222773*^9, 3.5186996898253717`*^9}, {3.5187010806642723`*^9, 
   3.518701087045055*^9}, {3.5369573365322113`*^9, 3.536957339500263*^9}, {
   3.5374101042618*^9, 3.5374101079877996`*^9}, {3.5463652236104*^9, 
   3.5463652586904*^9}, {3.568127948432659*^9, 3.5681279954027*^9}, {
   3.568131041313644*^9, 3.56813105227133*^9}, {3.5681313274174757`*^9, 
   3.568131327977957*^9}, {3.5681318705130177`*^9, 3.568131872855075*^9}, {
   3.568331583995309*^9, 3.568331588709426*^9}, {3.5683345365889673`*^9, 
   3.56833456945201*^9}, {3.568764538758832*^9, 3.568764539011806*^9}, {
   3.6682783901944723`*^9, 3.668278413379919*^9}, {3.676131464175607*^9, 
   3.6761314704008927`*^9}, {3.676253345360215*^9, 3.6762533456951084`*^9}, {
   3.676391646745941*^9, 3.676391670638501*^9}, {3.676392176242279*^9, 
   3.6763921772555265`*^9}, {3.6763923223199716`*^9, 
   3.6763923271822147`*^9}, {3.676392608199214*^9, 3.67639260910846*^9}, {
   3.6763927390932064`*^9, 3.676392740229664*^9}, {3.6763927769823985`*^9, 
   3.6763927779836493`*^9}, {3.6772468227285824`*^9, 3.677246825434145*^9}, {
   3.677428073001362*^9, 3.6774280973591614`*^9}, {3.677862913165207*^9, 
   3.6778629149234324`*^9}, {3.677865838308714*^9, 3.677865868609491*^9}, {
   3.677996460259065*^9, 3.677996462717582*^9}, {3.6779968012168684`*^9, 
   3.677996804383297*^9}, {3.6779968939043784`*^9, 3.6779969022245064`*^9}, {
   3.6779989635421534`*^9, 3.677998969814838*^9}, {3.6779992118154545`*^9, 
   3.6779992129534845`*^9}, {3.6780016784101973`*^9, 
   3.6780016811053686`*^9}, {3.6780017866209946`*^9, 
   3.6780017893733487`*^9}, {3.678001893820094*^9, 3.678001895109549*^9}, {
   3.684504901284915*^9, 3.684504918701826*^9}, {3.684681978298851*^9, 
   3.684681978746027*^9}, {3.685106690110389*^9, 3.68510669372801*^9}, 
   3.6859258177185984`*^9, {3.686323694321533*^9, 3.6863237045086527`*^9}, {
   3.686580243099815*^9, 3.686580243473839*^9}, {3.692460164020687*^9, 
   3.6924601666035066`*^9}, {3.7009452714141145`*^9, 3.7009452759526668`*^9}, 
   3.701700241980094*^9, {3.7017003731236258`*^9, 3.7017003745244703`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.546363064814*^9, 3.546363067493*^9}, {
  3.565745327189906*^9, 3.5657453277187843`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SetScatteringData", "[", 
      RowBox[{"aa_", ",", "bb_", ",", "rr_", ",", "ma_", ",", "mc_"}], "]"}], 
     ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", "k_", "]"}], ":=", 
         RowBox[{"rr", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", "ma"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "k_", "]"}], ":=", 
         RowBox[{"1", "+", " ", 
          RowBox[{
           RowBox[{"r", "[", "k", "]"}], 
           RowBox[{"cc", "[", 
            RowBox[{"r", "[", 
             RowBox[{"cc", "[", "k", "]"}], "]"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Tau]", "[", 
          RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "k_List", "]"}], ":=", 
         RowBox[{"\[Tau]", "/@", "k"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dom", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Truncate", "[", "globalTol", "]"}], "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Log", "[", 
               RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "el"}], ",", "el"}], "}"}], "]"}], ",", "100"}], 
            "}"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", "mc"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SetScatteringData", "[", 
      RowBox[{"aa_", ",", "bb_", ",", "rr_", ",", "rrb_", ",", "ma_"}], "]"}],
      ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", "k_", "]"}], ":=", 
         RowBox[{"rr", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"rb", "[", "k_", "]"}], ":=", 
           RowBox[{"rrb", "[", 
            RowBox[{"cc", "[", "k", "]"}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"a", "=", "ma"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "k_", "]"}], ":=", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"r", "[", "k", "]"}], 
           RowBox[{"cc", "[", 
            RowBox[{"r", "[", 
             RowBox[{"cc", "[", "k", "]"}], "]"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Tau]", "[", 
          RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "k_List", "]"}], ":=", 
         RowBox[{"\[Tau]", "/@", "k"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"dom", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Truncate", "[", "globalTol", "]"}], "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Log", "[", 
                 RowBox[{"1", "+", 
                  RowBox[{
                   RowBox[{"rsamp", "[", "#", "]"}], "^", "2"}]}], "]"}], 
                "&"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "el"}], ",", "el"}], "}"}], "]"}], ",", 
               "100"}], "}"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ma", "\[NotEqual]", " ", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"Fun", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"h", "[", "#", "]"}], "&"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", "10"}], 
              "]"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"f1", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"aa", "[", "#", "]"}], "-", "1"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{"0", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
              RowBox[{"2", "bigN"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"f2", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"aa", "[", "#", "]"}], "-", "1"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "\[Infinity]"}], ",", "0"}], "}"}], "]"}], ",", 
              
              RowBox[{"2", " ", "bigN"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"df1", "=", 
            RowBox[{"f1", "'"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"df2", "=", 
            RowBox[{"f2", "'"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"da", "[", "k_", "]"}], ":=", 
            RowBox[{
             RowBox[{"Cauchy", "[", 
              RowBox[{"df1", ",", "k"}], "]"}], "+", 
             RowBox[{"Cauchy", "[", 
              RowBox[{"df2", ",", "k"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", 
              RowBox[{"Length", "[", "ma", "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"c", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"c", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Quiet", "[", 
                    RowBox[{"bb", "[", 
                    RowBox[{"ma", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "/", 
                   RowBox[{"da", "[", 
                    RowBox[{"ma", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";"}]}], 
            RowBox[{"(*", 
             RowBox[{"compute", " ", "norming", " ", "constants"}], "*)"}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "c"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SetParams", "[", 
      RowBox[{
      "nu_", ",", "rad1_", ",", "tol_", ",", "sN_", ",", "bN_", ",", "eL_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Nu]", "=", "nu"}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "parameter", " ", "for", " ", "width", " ", "of", " ", "strip", " ", 
          "of", " ", "analyticity"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"rad", "=", "rad1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"globalTol", "=", "tol"}], ";", "\[IndentingNewLine]", 
        RowBox[{"smallN", "=", "sN"}], ";", "\[IndentingNewLine]", 
        RowBox[{"bigN", "=", "bN"}], ";", "\[IndentingNewLine]", 
        RowBox[{"el", "=", "eL"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetScatteringData", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "a", ",", "c"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Getnu", "[", "]"}], ":=", "\[Nu]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Setrsamp", "[", "h_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"rsamp", "=", "h"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Settimeflag", "[", "h_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"timeflag", "=", "h"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SetN", "[", "x_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{
        RowBox[{"bigN", "=", 
         RowBox[{"x", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"smallN", "=", 
         RowBox[{"x", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expconst", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"bigN", "=", "20"}], ";", "\[IndentingNewLine]", 
     RowBox[{"smallN", "=", "10"}], ";"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5463630695*^9, 3.546363080922*^9}, {3.546363115111*^9, 
   3.546363141222*^9}, {3.5463634376070004`*^9, 3.546363492512*^9}, {
   3.5463635258719997`*^9, 3.546363635209*^9}, {3.5463659693424*^9, 
   3.5463659740664*^9}, {3.5463660119104*^9, 3.5463661504323997`*^9}, {
   3.5463664883764*^9, 3.5463664944384003`*^9}, {3.5463666192464*^9, 
   3.5463666459524*^9}, {3.5463667113484*^9, 3.5463667373324003`*^9}, {
   3.5463676399364*^9, 3.5463676562564*^9}, {3.546390936499014*^9, 
   3.546390947510488*^9}, {3.546401541105667*^9, 3.5464015544196997`*^9}, {
   3.546434422083152*^9, 3.546434437782632*^9}, {3.563910175270574*^9, 
   3.563910220797307*^9}, {3.564799718336*^9, 3.564799720823*^9}, {
   3.5649679651156*^9, 3.5649679782296*^9}, {3.5655714809302*^9, 
   3.5655714994402*^9}, {3.5655715372522*^9, 3.5655715645132*^9}, {
   3.5656148581191998`*^9, 3.5656148586572*^9}, {3.5656173795022*^9, 
   3.5656173983492002`*^9}, {3.5656200626132*^9, 3.5656200714432*^9}, {
   3.5656203941162*^9, 3.5656204067612*^9}, {3.5656338952332*^9, 
   3.5656339009142*^9}, {3.5656343322771997`*^9, 3.5656343385042*^9}, {
   3.5657105818142*^9, 3.5657105820962*^9}, {3.5657106368512*^9, 
   3.5657106371591997`*^9}, {3.5657106923602*^9, 3.5657107507892*^9}, 
   3.5657108510002003`*^9, {3.5657130676252003`*^9, 3.5657130795922003`*^9}, {
   3.5657280484491997`*^9, 3.5657280561782*^9}, {3.5657313869382*^9, 
   3.5657314205002003`*^9}, {3.565744033573463*^9, 3.565744042518571*^9}, {
   3.565745333305562*^9, 3.565745362905344*^9}, {3.5657454278631887`*^9, 
   3.565745444786531*^9}, {3.5657455096709547`*^9, 3.5657455425153027`*^9}, {
   3.565746618412477*^9, 3.565746650258099*^9}, {3.565753896592372*^9, 
   3.56575390058217*^9}, {3.565753960980502*^9, 3.5657539672129097`*^9}, {
   3.565754087442314*^9, 3.565754191303976*^9}, {3.565754253265995*^9, 
   3.565754273708042*^9}, {3.565754484213047*^9, 3.5657544921511374`*^9}, {
   3.565755271816646*^9, 3.565755314332326*^9}, {3.568322803553039*^9, 
   3.568322821334434*^9}, {3.568331042850155*^9, 3.5683311066045713`*^9}, {
   3.568334249311112*^9, 3.568334262380498*^9}, 3.5683343178112087`*^9, {
   3.6683452832400265`*^9, 3.6683452838800282`*^9}, 3.6683470326898565`*^9, {
   3.6772592785766635`*^9, 3.6772592979050446`*^9}, {3.6772595984286556`*^9, 
   3.677259598539957*^9}, {3.677260224790374*^9, 3.6772602435001574`*^9}, 
   3.677260276186063*^9, {3.6772605010571203`*^9, 3.677260501171423*^9}, {
   3.677260675419882*^9, 3.6772606755131035`*^9}, {3.6772609944122744`*^9, 
   3.677261003508465*^9}, {3.6772612086710777`*^9, 3.6772612513686695`*^9}, 
   3.6772618955192327`*^9, {3.6848629627237315`*^9, 3.684862963447651*^9}, 
   3.6851067520049467`*^9, {3.6859258240346627`*^9, 3.6859258287671185`*^9}, {
   3.6859415425979877`*^9, 3.6859415471752467`*^9}, {3.685941589967687*^9, 
   3.6859415927870865`*^9}, 3.6859490034478273`*^9, 3.685951928900154*^9, {
   3.685975717446937*^9, 3.6859757177067547`*^9}, {3.686627503728454*^9, 
   3.6866275045410423`*^9}, {3.6880905227975836`*^9, 3.6880905228913436`*^9}, 
   3.6880911471282864`*^9, 3.688170291189498*^9, {3.6881719220892444`*^9, 
   3.688171936071994*^9}, 3.6888421488435793`*^9, 3.690037383094446*^9, {
   3.6900540534852123`*^9, 3.6900540536571054`*^9}, {3.6924595486428165`*^9, 
   3.6924595758516617`*^9}, {3.6930322316614466`*^9, 3.693032249968052*^9}, {
   3.6930325176168375`*^9, 3.6930325197023554`*^9}, 3.6930329863070545`*^9, {
   3.7011088468132915`*^9, 3.7011088523473067`*^9}, {3.7011089049320297`*^9, 
   3.701108918100727*^9}, {3.7011104324143867`*^9, 3.701110436831606*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reflection Coefficient", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5407685463534*^9, 3.5407685478054*^9}, {
  3.5657108306542*^9, 3.5657108348501997`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CME", "[", "x_", "]"}], ":=", 
   RowBox[{"Chop", "[", 
    RowBox[{"x", ",", "$MachineEpsilon"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScatteringMatrixFiniteSG", "[", 
     RowBox[{"q_", ",", "qt_", ",", "n_", ",", "el_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "qf", ",", "qtf", ",", "qxf", ",", "qfb", ",", "qtfb", ",", "qxfb", 
        ",", "Dm", ",", "Dmb", ",", "IIm", ",", "IImb", ",", "id", ",", "DM", 
        ",", "DMb", ",", "q\[Sigma]1", ",", "q\[Sigma]1b", ",", "J\[Sigma]3", 
        ",", "J\[Sigma]31", ",", "J\[Sigma]3b", ",", "J\[Sigma]31b", ",", 
        "rhs", ",", "A", ",", "Ab", ",", "xf", ",", "xfb"}], "}"}], ",", "\n",
       "       ", 
      RowBox[{
       RowBox[{"qf", "=", 
        RowBox[{"Fun", "[", 
         RowBox[{"q", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "el"}], ",", "0"}], "}"}], "]"}], ",", "n"}], 
         "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"Forward", " ", "scattering"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"qtf", "=", 
        RowBox[{"Fun", "[", 
         RowBox[{"qt", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "el"}], ",", "0"}], "}"}], "]"}], ",", "n"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qxf", "=", 
        RowBox[{"qf", "'"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "assume", " ", "the", " ", "diff", " ", "is", " ", "spectral"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"qfb", "=", 
        RowBox[{"Fun", "[", 
         RowBox[{"q", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "el"}], "}"}], "]"}], ",", "n"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qtfb", "=", 
        RowBox[{"Fun", "[", 
         RowBox[{"qt", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "el"}], "}"}], "]"}], ",", "n"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qxfb", "=", 
        RowBox[{"qfb", "'"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xf", "=", 
        RowBox[{"Fun", "[", 
         RowBox[{
          RowBox[{"#", "&"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "el"}], ",", "0"}], "}"}], "]"}], ",", "n"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xfb", "=", 
        RowBox[{"Fun", "[", 
         RowBox[{
          RowBox[{"#", "&"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "el"}], "}"}], "]"}], ",", "n"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"qf", "//", "Values"}], "//", "First"}], "//", "Abs"}], 
            ",", 
            RowBox[{"qf", "//", "DCTPlot"}], ",", 
            RowBox[{"qfb", "//", "DCTPlot"}]}], "}"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Dm", "=", 
        RowBox[{"DerivativeMatrix", "[", "qf", "]"}]}], ";", "      ", 
       RowBox[{"(*", 
        RowBox[{
        "this", " ", "gives", " ", "the", " ", "chebyshev", " ", 
         "differentiation", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Dmb", "=", 
        RowBox[{"DerivativeMatrix", "[", "qfb", "]"}]}], ";", "  ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"ie", "   ", 
          RowBox[{"Dm", " ", ".", " ", 
           RowBox[{"Values", "[", "qf", "]"}]}]}], " ", "=", " ", 
         RowBox[{"derivative", " ", "of", " ", "qf"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"IIm", "=", 
        RowBox[{"ReduceDimensionIntegrateMatrix", "[", "qf", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IImb", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ReduceDimensionIntegrateMatrix", "[", 
              RowBox[{"(", 
               RowBox[{"qfb", "//", "ReverseOrientation"}], ")"}], "]"}], "//",
              "Transpose"}], "//", "Reverse"}], "//", "Transpose"}], "//", 
          "Reverse"}], ")"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "integrate", " ", "in", " ", "the", " ", "opposite", " ", "direction",
          " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"value", " ", "at", " ", "x"}], "=", 
           RowBox[{"el", " ", "vanishes"}]}], ")"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ScatteringMatrixFiniteSG", "[", 
        RowBox[{
        "n", ",", "qf", ",", "qtf", ",", "qxf", ",", "qfb", ",", "qtfb", ",", 
         "qxfb", ",", "IIm", ",", "IImb", ",", "xf", ",", "xfb"}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScatteringMatrixFiniteSG", "[", 
     RowBox[{
     "n_", ",", "qf_", ",", "qtf_", ",", "qxf_", ",", "qfb_", ",", "qtfb_", 
      ",", "qxfb_", ",", "IIm_", ",", "IImb_", ",", "xf_", ",", "xfb_"}], 
     "]"}], "[", "w_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ans0", ",", "ans1", ",", "rhs", ",", "lhs", ",", "s1", ",", "s2", ",", 
       "ss1", ",", "qb", ",", "q", ",", "r", ",", "rb", ",", "z", ",", "Q11", 
       ",", "Q12", ",", "Q21", ",", "Q22", ",", "Qb11", ",", "Qb12", ",", 
       "Qb21", ",", "Qb22", ",", "A", ",", "Ab", ",", "J\[Sigma]3", ",", 
       "J\[Sigma]31", ",", "J\[Sigma]3b", ",", "J\[Sigma]31b", ",", "id", ",",
        "expzx", ",", "iexpzx", ",", "expzxb", ",", "iexpzxb"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"illcond", "=", "True"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "w", "]"}], ">", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"id", "=", 
          RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"z", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"w", "-", 
             RowBox[{"1", "/", "w"}]}], ")"}], "/", "4"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Q11", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"I", "/", "4"}], "/", "w"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", "qf", "]"}], "-", "1"}], ")"}]}], ")"}], 
            "  ", "//", "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Q12", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"I", "/", "4"}], "/", "w"}], "*", 
               RowBox[{"Sin", "[", "qf", "]"}]}], "-", 
              RowBox[{
               RowBox[{"1", "/", "4"}], "*", 
               RowBox[{"(", 
                RowBox[{"qtf", "+", "qxf"}], ")"}]}]}], ")"}], "  ", "//", 
            "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Q21", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"I", "/", "4"}], "/", "w"}], "*", 
               RowBox[{"Sin", "[", "qf", "]"}]}], "+", 
              RowBox[{
               RowBox[{"1", "/", "4"}], "*", 
               RowBox[{"(", 
                RowBox[{"qtf", "+", "qxf"}], ")"}]}]}], ")"}], " ", "//", 
            "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Q22", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"I", "/", "4"}], "/", "w"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cos", "[", "qf", "]"}], "-", "1"}], ")"}]}], 
              ")"}]}], " ", "//", "Values"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Qb11", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"I", "/", "4"}], "/", "w"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", "qfb", "]"}], "-", "1"}], ")"}]}], ")"}], 
            "  ", "//", "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Qb12", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"I", "/", "4"}], "/", "w"}], "*", 
               RowBox[{"Sin", "[", "qfb", "]"}]}], "-", 
              RowBox[{
               RowBox[{"1", "/", "4"}], "*", 
               RowBox[{"(", 
                RowBox[{"qtfb", "+", "qxfb"}], ")"}]}]}], ")"}], "  ", "//", 
            "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Qb21", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"I", "/", "4"}], "/", "w"}], "*", 
               RowBox[{"Sin", "[", "qfb", "]"}]}], "+", 
              RowBox[{
               RowBox[{"1", "/", "4"}], "*", 
               RowBox[{"(", 
                RowBox[{"qtfb", "+", "qxfb"}], ")"}]}]}], ")"}], " ", "//", 
            "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Qb22", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"I", "/", "4"}], "/", "w"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cos", "[", "qfb", "]"}], "-", "1"}], ")"}]}], 
              ")"}]}], " ", "//", "Values"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"expzx", "=", 
            RowBox[{"DiagonalMatrix", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Exp", "[", 
                RowBox[{"2", "*", "I", "*", "z", "*", "xf"}], "]"}], ")"}], "//",
               "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"iexpzx", "=", 
            RowBox[{"DiagonalMatrix", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], "*", "I", "*", "z", "*", "xf"}], "]"}], 
               ")"}], "//", "Values"}], "]"}]}], ";", " ", 
           RowBox[{"(*", "inverse", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"expzxb", "=", 
            RowBox[{"DiagonalMatrix", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Exp", "[", 
                RowBox[{"2", "*", "I", "*", "z", "*", "xfb"}], "]"}], ")"}], "//",
               "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"iexpzxb", "=", 
            RowBox[{"DiagonalMatrix", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], "*", "I", "*", "z", "*", "xfb"}], "]"}], 
               ")"}], "//", "Values"}], "]"}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"J\[Sigma]3", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0", "*", "id"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"-", "2"}], "I", " ", "IIm"}]}], "}"}]}], "}"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"J\[Sigma]31", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "I", " ", "IIm"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"0", "*", "id"}]}], "}"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"J\[Sigma]3b", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0", "*", "id"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"-", "2"}], "I", " ", "IImb"}]}], "}"}]}], "}"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"J\[Sigma]31b", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "I", " ", "IImb"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"0", "*", "id"}]}], "}"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"A", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"id", "-", 
                RowBox[{"IIm", ".", "Q11"}]}], ",", 
               RowBox[{"-", 
                RowBox[{"IIm", ".", "Q12"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"IIm", ".", "Q21"}]}], ",", 
               RowBox[{"id", "-", 
                RowBox[{"IIm", ".", "Q22"}]}]}], "}"}]}], "}"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Ab", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"id", "-", 
                RowBox[{"IImb", ".", "Qb11"}]}], ",", 
               RowBox[{"-", 
                RowBox[{"IImb", ".", "Qb12"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"IImb", ".", "Qb21"}]}], ",", 
               RowBox[{"id", "-", 
                RowBox[{"IImb", ".", "Qb22"}]}]}], "}"}]}], "}"}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"On", "[", 
          RowBox[{"LinearSolve", "::", "luc"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lhs", "=", 
          RowBox[{"A", "+", " ", 
           RowBox[{"z", "*", "J\[Sigma]3"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rhs", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"IIm", ".", 
             RowBox[{"Diagonal", "[", "Q11", "]"}]}], ",", 
            RowBox[{"IIm", ".", 
             RowBox[{"Diagonal", "[", "Q21", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"illcond", ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Linear solve 1 cond=\>\"", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"SingularValueList", "[", 
                RowBox[{"lhs", ",", 
                 RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
              RowBox[{"Min", "[", 
               RowBox[{"SingularValueList", "[", 
                RowBox[{"lhs", ",", 
                 RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"SingularValueList", "[", 
             RowBox[{"lhs", "//", "CME"}], "]"}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"illlhs", "=", "lhs"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ans0", " ", "=", " ", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{
            RowBox[{"lhs", "//", "CME"}], ",", 
            RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"lhs", "=", 
          RowBox[{"A", "+", 
           RowBox[{"z", "*", "J\[Sigma]31"}]}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"rhs", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"IIm", ".", 
              RowBox[{"Diagonal", "[", "Q12", "]"}]}]}], ",", 
            RowBox[{"-", 
             RowBox[{"IIm", ".", 
              RowBox[{"Diagonal", "[", "Q22", "]"}]}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Linear solve 2 cond=\>\"", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"SingularValueList", "[", "lhs", "]"}], "]"}], "/", 
              RowBox[{"Min", "[", 
               RowBox[{"SingularValueList", "[", "lhs", "]"}], "]"}]}]}], 
            "]"}], ";"}], "*)"}], 
         RowBox[{"ans1", " ", "=", " ", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{
            RowBox[{"lhs", "//", "CME"}], ",", 
            RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"A", "=", 
            RowBox[{"BlockMatrix", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"id", "-", 
                  RowBox[{"IIm", ".", "expzx", ".", "Q11", ".", "iexpzx"}]}], 
                 ",", 
                 RowBox[{"-", 
                  RowBox[{"IIm", ".", "expzx", ".", "Q12"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"IIm", ".", "Q21", ".", "iexpzx"}]}], ",", 
                 RowBox[{"id", "-", 
                  RowBox[{"IIm", ".", "Q22"}]}]}], "}"}]}], "}"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"lhs", "=", "A"}], ";", "\[IndentingNewLine]", 
           RowBox[{"rhs", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"IIm", ".", "expzx", ".", 
                RowBox[{"Diagonal", "[", "Q12", "]"}]}]}], ",", 
              RowBox[{"-", 
               RowBox[{"IIm", ".", 
                RowBox[{"Diagonal", "[", "Q22", "]"}]}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"illcond", ",", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Linear solve 2 cond=\>\"", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{"SingularValueList", "[", 
                  RowBox[{"lhs", ",", 
                   RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
                RowBox[{"Min", "[", 
                 RowBox[{"SingularValueList", "[", 
                  RowBox[{"lhs", ",", 
                   RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"ans1", " ", "=", " ", 
            RowBox[{"LinearSolve", "[", 
             RowBox[{
              RowBox[{"lhs", "//", "CME"}], ",", 
              RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"cond2", "=", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"SingularValueList", "[", 
               RowBox[{"lhs", ",", 
                RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
             RowBox[{"Min", "[", 
              RowBox[{"SingularValueList", "[", 
               RowBox[{"lhs", ",", 
                RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
           ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"cond2", "=", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"SingularValueList", "[", 
             RowBox[{"lhs", ",", 
              RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
           RowBox[{"Min", "[", 
            RowBox[{"SingularValueList", "[", 
             RowBox[{"lhs", ",", 
              RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"s1", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"ans0", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "+", "1"}], ",", 
              RowBox[{"ans1", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ans0", "[", 
               RowBox[{"[", 
                RowBox[{"2", "n"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"ans1", "[", 
                RowBox[{"[", 
                 RowBox[{"2", "n"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
           "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"ss1", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"ans0", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], "+", "1"}], ",", 
                RowBox[{"-", 
                 RowBox[{"ans1", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ans0", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", "n"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"ans1", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", "n"}], "]"}], "]"}]}], "-", "1"}]}], "}"}]}],
              "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"s1", ",", "ss1"}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Ab", "=", 
            RowBox[{"BlockMatrix", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"id", "-", 
                  RowBox[{"IImb", ".", "Qb11"}]}], ",", 
                 RowBox[{"-", 
                  RowBox[{"IImb", ".", "Qb12"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{
                  "expzxb", ".", "IImb", ".", "iexpzxb", ".", "Qb21"}]}], ",", 
                 RowBox[{"id", "-", 
                  RowBox[{
                  "expzxb", ".", "IImb", ".", "iexpzxb", ".", "Qb22"}]}]}], 
                "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"lhs", "=", "Ab"}], ";", "\[IndentingNewLine]", 
           RowBox[{"rhs", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"IImb", ".", 
               RowBox[{"Diagonal", "[", "Qb11", "]"}]}], ",", 
              RowBox[{"expzxb", ".", "IImb", ".", "iexpzxb", ".", 
               RowBox[{"Diagonal", "[", "Qb21", "]"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Linear solve 3 cond=\>\"", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"SingularValueList", "[", 
                RowBox[{"lhs", ",", 
                 RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
              RowBox[{"Min", "[", 
               RowBox[{"SingularValueList", "[", 
                RowBox[{"lhs", ",", 
                 RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"ans0", " ", "=", " ", 
            RowBox[{"LinearSolve", "[", 
             RowBox[{
              RowBox[{"lhs", "//", "CME"}], ",", 
              RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"combined", " ", "exp"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Ab", "=", 
            RowBox[{"BlockMatrix", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"id", "-", 
                  RowBox[{"IImb", ".", "Qb11"}]}], ",", 
                 RowBox[{"-", 
                  RowBox[{"IImb", ".", "Qb12", ".", "expzxb"}]}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"IImb", ".", "iexpzxb", ".", "Qb21"}]}], ",", 
                 RowBox[{"id", "-", 
                  RowBox[{
                  "IImb", ".", "iexpzxb", ".", "Qb22", ".", "expzxb"}]}]}], 
                "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"lhs", "=", "Ab"}], ";", "\[IndentingNewLine]", 
           RowBox[{"rhs", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"IImb", ".", 
               RowBox[{"Diagonal", "[", "Qb11", "]"}]}], ",", 
              RowBox[{"IImb", ".", "iexpzxb", ".", 
               RowBox[{"Diagonal", "[", "Qb21", "]"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"illcond", ",", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Linear solve 3 cond=\>\"", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{"SingularValueList", "[", 
                  RowBox[{"lhs", ",", 
                   RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
                RowBox[{"Min", "[", 
                 RowBox[{"SingularValueList", "[", 
                  RowBox[{"lhs", ",", 
                   RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"ans0", " ", "=", " ", 
            RowBox[{"LinearSolve", "[", 
             RowBox[{
              RowBox[{"lhs", "//", "CME"}], ",", 
              RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Ab", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"id", "-", 
                RowBox[{"IImb", ".", "Qb11"}]}], ",", 
               RowBox[{"-", 
                RowBox[{"IImb", ".", "Qb12"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"IImb", ".", "Qb21"}]}], ",", 
               RowBox[{"id", "-", 
                RowBox[{"IImb", ".", "Qb22"}]}]}], "}"}]}], "}"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"lhs", "=", 
          RowBox[{"Ab", "+", " ", 
           RowBox[{"z", "*", "J\[Sigma]3b"}]}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"rhs", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"IImb", ".", 
             RowBox[{"Diagonal", "[", "Qb11", "]"}]}], ",", 
            RowBox[{"IImb", ".", 
             RowBox[{"Diagonal", "[", "Qb21", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Linear solve 3 cond=\>\"", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"SingularValueList", "[", "lhs", "]"}], "]"}], "/", 
              RowBox[{"Min", "[", 
               RowBox[{"SingularValueList", "[", "lhs", "]"}], "]"}]}]}], 
            "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"ans0", " ", "=", " ", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{
            RowBox[{"lhs", "//", "CME"}], ",", 
            RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Ab", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"id", "-", 
                RowBox[{"IImb", ".", "Qb11"}]}], ",", 
               RowBox[{"-", 
                RowBox[{"IImb", ".", "Qb12"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"IImb", ".", "Qb21"}]}], ",", 
               RowBox[{"id", "-", 
                RowBox[{"IImb", ".", "Qb22"}]}]}], "}"}]}], "}"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"lhs", "=", 
          RowBox[{"Ab", "+", " ", 
           RowBox[{"z", "*", "J\[Sigma]31b"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rhs", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"IImb", ".", 
             RowBox[{"Diagonal", "[", "Qb12", "]"}]}], ",", 
            RowBox[{"IImb", ".", 
             RowBox[{"Diagonal", "[", "Qb22", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"illcond", ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Linear solve 4 cond=\>\"", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"SingularValueList", "[", 
                RowBox[{"lhs", ",", 
                 RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
              RowBox[{"Min", "[", 
               RowBox[{"SingularValueList", "[", 
                RowBox[{"lhs", ",", 
                 RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ans1", " ", "=", " ", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{
            RowBox[{"lhs", "//", "CME"}], ",", 
            RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"On", "[", 
          RowBox[{"LinearSolve", "::", "luc"}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"s2", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"ans0", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
              RowBox[{"ans1", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ans0", "[", 
               RowBox[{"[", 
                RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"ans1", "[", 
                RowBox[{"[", 
                 RowBox[{"n", "+", "1"}], "]"}], "]"}], "+", "1"}]}], "}"}]}],
            "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Inverse", "[", "s2", "]"}], ".", "s1"}], ",", 
             RowBox[{
              RowBox[{"Inverse", "[", "s2", "]"}], ".", "ss1"}]}], "]"}], 
           ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"illcond", ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "s1", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"illcond", ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "s2", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"s1", "=", 
           RowBox[{
            RowBox[{"Inverse", "[", "s2", "]"}], ".", "s1"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"s1", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"s2", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"s2", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"s2", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
                 RowBox[{"s2", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], "}"}], 
             "/", 
             RowBox[{"Det", "[", "s2", "]"}]}], ")"}], ".", "s1"}]}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"inside", " ", "unit", " ", "circle"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Using", " ", "exp", " ", "integrator"}], ",", " ", 
           RowBox[{
           "but", " ", "for", " ", "z", " ", "real", " ", "goes", " ", "to", 
            " ", "zero", "  ", "it", " ", "is", " ", "not", " ", 
            "correct"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"z", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "-", 
              RowBox[{"1", "/", "w"}]}], ")"}], "/", "4"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"expzx", "=", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Exp", "[", 
               RowBox[{"2", "*", "I", "*", "z", "*", "xf"}], "]"}], ")"}], "//",
              "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"iexpzx", "=", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], "*", "I", "*", "z", "*", "xf"}], "]"}], 
              ")"}], "//", "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"expzxb", "=", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Exp", "[", 
               RowBox[{"2", "*", "I", "*", "z", "*", "xfb"}], "]"}], ")"}], "//",
              "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"iexpzxb", "=", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], "*", "I", "*", "z", "*", "xfb"}], "]"}], 
              ")"}], "//", "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"id", "=", 
           RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Q11", " ", "=", " ", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"I", "/", "4"}], "*", "w", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cos", "[", "qf", "]"}], "-", "1"}], ")"}]}], ")"}], 
             "  ", "//", "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Q12", " ", "=", " ", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"-", "I"}], "/", "4"}], "*", "w", "*", 
                RowBox[{"Sin", "[", "qf", "]"}]}], "-", 
               RowBox[{
                RowBox[{"1", "/", "4"}], "*", 
                RowBox[{"(", 
                 RowBox[{"qxf", "-", "qtf"}], ")"}]}]}], ")"}], "  ", "//", 
             "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Q21", " ", "=", " ", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"-", "I"}], "/", "4"}], "*", "w", "*", 
                RowBox[{"Sin", "[", "qf", "]"}]}], "+", 
               RowBox[{
                RowBox[{"1", "/", "4"}], "*", 
                RowBox[{"(", 
                 RowBox[{"qxf", "-", "qtf"}], ")"}]}]}], ")"}], " ", "//", 
             "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Q22", " ", "=", " ", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"I", "/", "4"}], "*", "w", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", "qf", "]"}], "-", "1"}], ")"}]}], 
               ")"}]}], " ", "//", "Values"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Qb11", " ", "=", " ", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"I", "/", "4"}], "*", "w", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cos", "[", "qfb", "]"}], "-", "1"}], ")"}]}], ")"}],
              "  ", "//", "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Qb12", " ", "=", " ", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"-", "I"}], "/", "4"}], "*", "w", "*", 
                RowBox[{"Sin", "[", "qfb", "]"}]}], "-", 
               RowBox[{
                RowBox[{"1", "/", "4"}], "*", 
                RowBox[{"(", 
                 RowBox[{"qxfb", "-", "qtfb"}], ")"}]}]}], ")"}], "  ", "//", 
             "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Qb21", " ", "=", " ", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"-", "I"}], "/", "4"}], "*", "w", "*", 
                RowBox[{"Sin", "[", "qfb", "]"}]}], "+", 
               RowBox[{
                RowBox[{"1", "/", "4"}], "*", 
                RowBox[{"(", 
                 RowBox[{"qxfb", "-", "qtfb"}], ")"}]}]}], ")"}], " ", "//", 
             "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Qb22", " ", "=", " ", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"I", "/", "4"}], "*", "w", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", "qfb", "]"}], "-", "1"}], ")"}]}], 
               ")"}]}], " ", "//", "Values"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"J\[Sigma]3", "=", 
           RowBox[{"BlockMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"0", "*", "id"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"-", "2"}], "I", " ", "IIm"}]}], "}"}]}], "}"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"J\[Sigma]31", "=", 
           RowBox[{"BlockMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"2", "I", " ", "IIm"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"0", "*", "id"}]}], "}"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"J\[Sigma]3b", "=", 
           RowBox[{"BlockMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"0", "*", "id"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"-", "2"}], "I", " ", "IImb"}]}], "}"}]}], "}"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"J\[Sigma]31b", "=", 
           RowBox[{"BlockMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"2", "I", " ", "IImb"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"0", "*", "id"}]}], "}"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"BlockMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"id", "+", 
                 RowBox[{"IIm", ".", "Q11"}]}], ",", 
                RowBox[{"+", 
                 RowBox[{"IIm", ".", "Q12"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"+", 
                 RowBox[{"IIm", ".", "Q21"}]}], ",", 
                RowBox[{"id", "+", 
                 RowBox[{"IIm", ".", "Q22"}]}]}], "}"}]}], "}"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Ab", "=", 
           RowBox[{"BlockMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"id", "+", 
                 RowBox[{"IImb", ".", "Qb11"}]}], ",", 
                RowBox[{"+", 
                 RowBox[{"IImb", ".", "Qb12"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"+", 
                 RowBox[{"IImb", ".", "Qb21"}]}], ",", 
                RowBox[{"id", "+", 
                 RowBox[{"IImb", ".", "Qb22"}]}]}], "}"}]}], "}"}], "]"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"On", "[", 
           RowBox[{"LinearSolve", "::", "luc"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"lhs", "=", 
           RowBox[{"A", "+", " ", 
            RowBox[{"z", "*", "J\[Sigma]3"}]}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"rhs", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"IIm", ".", 
               RowBox[{"Diagonal", "[", "Q11", "]"}]}]}], ",", 
             RowBox[{"-", 
              RowBox[{"IIm", ".", 
               RowBox[{"Diagonal", "[", "Q21", "]"}]}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"illcond", ",", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Linear solve 1 cond=\>\"", ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
               
               RowBox[{"Min", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"SingularValueList", "[", 
              RowBox[{"lhs", "//", "CME"}], "]"}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"illlhs", "=", "lhs"}], ";", "\[IndentingNewLine]", 
          RowBox[{"ans0", " ", "=", " ", 
           RowBox[{"LinearSolve", "[", 
            RowBox[{
             RowBox[{"lhs", "//", "CME"}], ",", 
             RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"BlockMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"id", "+", 
                 RowBox[{"iexpzx", ".", "IIm", ".", "expzx", ".", "Q11"}]}], 
                ",", 
                RowBox[{"+", 
                 RowBox[{"iexpzx", ".", "IIm", ".", "expzx", ".", "Q12"}]}]}],
                "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"+", 
                 RowBox[{"IIm", ".", "Q21"}]}], ",", 
                RowBox[{"id", "+", 
                 RowBox[{"IIm", ".", "Q22"}]}]}], "}"}]}], "}"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"lhs", "=", "A"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rhs", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"+", 
              RowBox[{"iexpzx", ".", "IIm", ".", "expzx", ".", 
               RowBox[{"Diagonal", "[", "Q12", "]"}]}]}], ",", 
             RowBox[{"+", 
              RowBox[{"IIm", ".", 
               RowBox[{"Diagonal", "[", "Q22", "]"}]}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"illcond", ",", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Linear solve 2 cond=\>\"", ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
               
               RowBox[{"Min", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"ans1", " ", "=", " ", 
           RowBox[{"LinearSolve", "[", 
            RowBox[{
             RowBox[{"lhs", "//", "CME"}], ",", 
             RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cond2", "=", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"SingularValueList", "[", 
              RowBox[{"lhs", ",", 
               RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
            RowBox[{"Min", "[", 
             RowBox[{"SingularValueList", "[", 
              RowBox[{"lhs", ",", 
               RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"s1", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"ans0", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "+", "1"}], ",", 
               RowBox[{"ans1", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ans0", "[", 
                RowBox[{"[", 
                 RowBox[{"2", "n"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"ans1", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", "n"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
            "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"ss1", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ans0", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "+", "1"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"ans1", "[", 
                   RowBox[{"[", "n", "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ans0", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", "n"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"ans1", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "n"}], "]"}], "]"}]}], "-", "1"}]}], "}"}]}],
               "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"s1", ",", "ss1"}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Ab", "=", 
           RowBox[{"BlockMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"id", "+", 
                 RowBox[{"IImb", ".", "Qb11"}]}], ",", 
                RowBox[{"+", 
                 RowBox[{"IImb", ".", "Qb12"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"+", 
                 RowBox[{
                 "expzxb", ".", "IImb", ".", "iexpzxb", ".", "Qb21"}]}], ",", 
                
                RowBox[{"id", "+", 
                 RowBox[{
                 "expzxb", ".", "IImb", ".", "iexpzxb", ".", "Qb22"}]}]}], 
               "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"lhs", "=", "Ab"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rhs", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"IImb", ".", 
               RowBox[{"Diagonal", "[", "Qb11", "]"}]}]}], ",", 
             RowBox[{"-", 
              RowBox[{"expzxb", ".", "IImb", ".", "iexpzxb", ".", 
               RowBox[{"Diagonal", "[", "Qb21", "]"}]}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"illcond", ",", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Linear solve 3 cond=\>\"", ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
               
               RowBox[{"Min", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"ans0", " ", "=", " ", 
           RowBox[{"LinearSolve", "[", 
            RowBox[{
             RowBox[{"lhs", "//", "CME"}], ",", 
             RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Ab", "=", 
           RowBox[{"BlockMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"id", "+", 
                 RowBox[{"IImb", ".", "Qb11"}]}], ",", 
                RowBox[{"+", 
                 RowBox[{"IImb", ".", "Qb12"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"+", 
                 RowBox[{"IImb", ".", "Qb21"}]}], ",", 
                RowBox[{"id", "+", 
                 RowBox[{"IImb", ".", "Qb22"}]}]}], "}"}]}], "}"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"lhs", "=", 
           RowBox[{"Ab", "+", " ", 
            RowBox[{"z", "*", "J\[Sigma]31b"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rhs", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"IImb", ".", 
               RowBox[{"Diagonal", "[", "Qb12", "]"}]}]}], ",", 
             RowBox[{"-", 
              RowBox[{"IImb", ".", 
               RowBox[{"Diagonal", "[", "Qb22", "]"}]}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"illcond", ",", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Linear solve 4 cond=\>\"", ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
               
               RowBox[{"Min", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"ans1", " ", "=", " ", 
           RowBox[{"LinearSolve", "[", 
            RowBox[{
             RowBox[{"lhs", "//", "CME"}], ",", 
             RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"v2", " ", "just", " ", "use", " ", "zero", " ", "gauge"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"z", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"w", "-", 
             RowBox[{"1", "/", "w"}]}], ")"}], "/", "4"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"id", "=", 
          RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Q11", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"I", "/", "4"}], "*", "w", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", "qf", "]"}], "-", "1"}], ")"}]}], ")"}], 
            "  ", "//", "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Q12", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "I"}], "/", "4"}], "*", "w", "*", 
               RowBox[{"Sin", "[", "qf", "]"}]}], "-", 
              RowBox[{
               RowBox[{"1", "/", "4"}], "*", 
               RowBox[{"(", 
                RowBox[{"qxf", "-", "qtf"}], ")"}]}]}], ")"}], "  ", "//", 
            "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Q21", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "I"}], "/", "4"}], "*", "w", "*", 
               RowBox[{"Sin", "[", "qf", "]"}]}], "+", 
              RowBox[{
               RowBox[{"1", "/", "4"}], "*", 
               RowBox[{"(", 
                RowBox[{"qxf", "-", "qtf"}], ")"}]}]}], ")"}], " ", "//", 
            "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Q22", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"I", "/", "4"}], "*", "w", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cos", "[", "qf", "]"}], "-", "1"}], ")"}]}], 
              ")"}]}], " ", "//", "Values"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Qb11", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"I", "/", "4"}], "*", "w", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", "qfb", "]"}], "-", "1"}], ")"}]}], ")"}], 
            "  ", "//", "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Qb12", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "I"}], "/", "4"}], "*", "w", "*", 
               RowBox[{"Sin", "[", "qfb", "]"}]}], "-", 
              RowBox[{
               RowBox[{"1", "/", "4"}], "*", 
               RowBox[{"(", 
                RowBox[{"qxfb", "-", "qtfb"}], ")"}]}]}], ")"}], "  ", "//", 
            "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Qb21", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "I"}], "/", "4"}], "*", "w", "*", 
               RowBox[{"Sin", "[", "qfb", "]"}]}], "+", 
              RowBox[{
               RowBox[{"1", "/", "4"}], "*", 
               RowBox[{"(", 
                RowBox[{"qxfb", "-", "qtfb"}], ")"}]}]}], ")"}], " ", "//", 
            "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Qb22", " ", "=", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"I", "/", "4"}], "*", "w", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cos", "[", "qfb", "]"}], "-", "1"}], ")"}]}], 
              ")"}]}], " ", "//", "Values"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"J\[Sigma]3", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0", "*", "id"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"-", "2"}], "I", " ", "IIm"}]}], "}"}]}], "}"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"J\[Sigma]31", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "I", " ", "IIm"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"0", "*", "id"}]}], "}"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"J\[Sigma]3b", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0", "*", "id"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"-", "2"}], "I", " ", "IImb"}]}], "}"}]}], "}"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"J\[Sigma]31b", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "I", " ", "IImb"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"0", "*", "id"}]}], "}"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"A", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"id", "+", 
                RowBox[{"IIm", ".", "Q11"}]}], ",", 
               RowBox[{"+", 
                RowBox[{"IIm", ".", "Q12"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"+", 
                RowBox[{"IIm", ".", "Q21"}]}], ",", 
               RowBox[{"id", "+", 
                RowBox[{"IIm", ".", "Q22"}]}]}], "}"}]}], "}"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Ab", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"id", "+", 
                RowBox[{"IImb", ".", "Qb11"}]}], ",", 
               RowBox[{"+", 
                RowBox[{"IImb", ".", "Qb12"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"+", 
                RowBox[{"IImb", ".", "Qb21"}]}], ",", 
               RowBox[{"id", "+", 
                RowBox[{"IImb", ".", "Qb22"}]}]}], "}"}]}], "}"}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"On", "[", 
          RowBox[{"LinearSolve", "::", "luc"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lhs", "=", 
          RowBox[{"A", "+", " ", 
           RowBox[{"z", "*", "J\[Sigma]3"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rhs", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"IIm", ".", 
              RowBox[{"Diagonal", "[", "Q11", "]"}]}]}], ",", 
            RowBox[{"-", 
             RowBox[{"IIm", ".", 
              RowBox[{"Diagonal", "[", "Q21", "]"}]}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"illcond", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Linear solve 1 cond=\>\"", ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
               
               RowBox[{"Min", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
             "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"SingularValueList", "[", 
             RowBox[{"lhs", "//", "CME"}], "]"}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"illlhs", "=", "lhs"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ans0", " ", "=", " ", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{
            RowBox[{"lhs", "//", "CME"}], ",", 
            RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"lhs", "=", 
          RowBox[{"A", "+", " ", 
           RowBox[{"z", "*", "J\[Sigma]31"}]}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"rhs", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"IIm", ".", 
             RowBox[{"Diagonal", "[", "Q12", "]"}]}], ",", 
            RowBox[{"IIm", ".", 
             RowBox[{"Diagonal", "[", "Q22", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"illcond", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Linear solve 2 cond=\>\"", ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
               
               RowBox[{"Min", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
             "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ans1", " ", "=", " ", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{
            RowBox[{"lhs", "//", "CME"}], ",", 
            RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cond2", "=", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"SingularValueList", "[", 
             RowBox[{"lhs", ",", 
              RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
           RowBox[{"Min", "[", 
            RowBox[{"SingularValueList", "[", 
             RowBox[{"lhs", ",", 
              RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"s1", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"ans0", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "+", "1"}], ",", 
              RowBox[{"ans1", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ans0", "[", 
               RowBox[{"[", 
                RowBox[{"2", "n"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"ans1", "[", 
                RowBox[{"[", 
                 RowBox[{"2", "n"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
           "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"ss1", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"ans0", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], "+", "1"}], ",", 
                RowBox[{"-", 
                 RowBox[{"ans1", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ans0", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", "n"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"ans1", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", "n"}], "]"}], "]"}]}], "-", "1"}]}], "}"}]}],
              "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"s1", ",", "ss1"}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Ab", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"id", "+", 
                RowBox[{"IImb", ".", "Qb11"}]}], ",", 
               RowBox[{"+", 
                RowBox[{"IImb", ".", "Qb12"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"+", 
                RowBox[{"IImb", ".", "Qb21"}]}], ",", 
               RowBox[{"id", "+", 
                RowBox[{"IImb", ".", "Qb22"}]}]}], "}"}]}], "}"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"lhs", "=", 
          RowBox[{"Ab", "+", " ", 
           RowBox[{"z", "*", "J\[Sigma]3b"}]}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"rhs", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"IImb", ".", 
              RowBox[{"Diagonal", "[", "Qb11", "]"}]}]}], ",", 
            RowBox[{"-", 
             RowBox[{"IImb", ".", 
              RowBox[{"Diagonal", "[", "Qb21", "]"}]}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"illcond", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Linear solve 3 cond=\>\"", ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
               
               RowBox[{"Min", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
             "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ans0", " ", "=", " ", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{
            RowBox[{"lhs", "//", "CME"}], ",", 
            RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Ab", "=", 
          RowBox[{"BlockMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"id", "+", 
                RowBox[{"IImb", ".", "Qb11"}]}], ",", 
               RowBox[{"+", 
                RowBox[{"IImb", ".", "Qb12"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"+", 
                RowBox[{"IImb", ".", "Qb21"}]}], ",", 
               RowBox[{"id", "+", 
                RowBox[{"IImb", ".", "Qb22"}]}]}], "}"}]}], "}"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"lhs", "=", 
          RowBox[{"Ab", "+", " ", 
           RowBox[{"z", "*", "J\[Sigma]31b"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rhs", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"IImb", ".", 
              RowBox[{"Diagonal", "[", "Qb12", "]"}]}]}], ",", 
            RowBox[{"-", 
             RowBox[{"IImb", ".", 
              RowBox[{"Diagonal", "[", "Qb22", "]"}]}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"illcond", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Linear solve 4 cond=\>\"", ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
               
               RowBox[{"Min", "[", 
                RowBox[{"SingularValueList", "[", 
                 RowBox[{"lhs", ",", 
                  RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
             "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ans1", " ", "=", " ", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{
            RowBox[{"lhs", "//", "CME"}], ",", 
            RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"On", "[", 
          RowBox[{"LinearSolve", "::", "luc"}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"s2", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"ans0", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
              RowBox[{"ans1", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ans0", "[", 
               RowBox[{"[", 
                RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"ans1", "[", 
                RowBox[{"[", 
                 RowBox[{"n", "+", "1"}], "]"}], "]"}], "+", "1"}]}], "}"}]}],
            "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Inverse", "[", "s2", "]"}], ".", "s1"}], ",", 
             RowBox[{
              RowBox[{"Inverse", "[", "s2", "]"}], ".", "ss1"}]}], "]"}], 
           ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"illcond", ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "s1", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"illcond", ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "s2", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"s1", "=", 
           RowBox[{
            RowBox[{"Inverse", "[", "s2", "]"}], ".", "s1"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"s1", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"s2", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"s2", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"s2", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
                 RowBox[{"s2", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], "}"}], 
             "/", 
             RowBox[{"Det", "[", "s2", "]"}]}], ")"}], ".", "s1"}]}], ";"}]}],
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<computing \[Rho](\>\"", ",", "w", ",", "\"\<)\>\""}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "s1", ";", 
      "\[IndentingNewLine]", "cond2"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5407710794914*^9, 3.5407710807813997`*^9}, {
   3.5407711951854*^9, 3.5407712059854*^9}, {3.5407712856654*^9, 
   3.5407713737354*^9}, {3.540827282042986*^9, 3.540827333330905*^9}, {
   3.54083242807616*^9, 3.5408324852837*^9}, {3.540832522921386*^9, 
   3.5408325930834007`*^9}, {3.540832938848312*^9, 3.540832960757762*^9}, {
   3.540832994793727*^9, 3.5408330192890873`*^9}, {3.540833097880999*^9, 
   3.540833104398241*^9}, {3.5408331497947607`*^9, 3.540833157137931*^9}, {
   3.540833189894033*^9, 3.540833239916215*^9}, {3.5408333534680634`*^9, 
   3.540833375999275*^9}, {3.540833439903254*^9, 3.540833457391617*^9}, 
   3.5409039382404003`*^9, {3.5409378931194*^9, 3.5409379107794*^9}, {
   3.5409397365383997`*^9, 3.5409397675624*^9}, 3.5409398277864*^9, {
   3.5409399836464*^9, 3.5409399892994003`*^9}, {3.5409422127864*^9, 
   3.5409422401823997`*^9}, {3.541851859895*^9, 3.541851909367*^9}, {
   3.5418522254849997`*^9, 3.541852231517*^9}, {3.5418533264820004`*^9, 
   3.541853326612*^9}, {3.5463628431070004`*^9, 3.5463628486429996`*^9}, {
   3.5463662630164003`*^9, 3.5463662636764*^9}, {3.5656340548582*^9, 
   3.5656340797651997`*^9}, {3.5656341116712*^9, 3.5656341309472*^9}, {
   3.5656341613592*^9, 3.5656341633571997`*^9}, {3.5657105213012*^9, 
   3.5657105408712*^9}, {3.5657557671034803`*^9, 3.5657557769551697`*^9}, {
   3.5657559916336403`*^9, 3.5657559932735453`*^9}, {3.568127174586278*^9, 
   3.568127201459868*^9}, {3.668347079313946*^9, 3.66834708163835*^9}, {
   3.6683471547423444`*^9, 3.668347160427372*^9}, 3.6797760109008417`*^9, {
   3.679777069794012*^9, 3.679777074475469*^9}, {3.679777129418659*^9, 
   3.679777142857415*^9}, {3.679777239231845*^9, 3.6797772455656977`*^9}, 
   3.6797775493660374`*^9, 3.6797828178560658`*^9, {3.684177624921265*^9, 
   3.684177626070489*^9}, {3.6841776924672256`*^9, 3.6841776927447166`*^9}, {
   3.6842474325928216`*^9, 3.684247491799766*^9}, 3.684462915762129*^9, {
   3.684470595679343*^9, 3.6844706417108173`*^9}, {3.684504867520049*^9, 
   3.684504889174183*^9}, {3.6845050864951787`*^9, 3.6845051727099795`*^9}, {
   3.6846956027035513`*^9, 3.6846956561851883`*^9}, {3.6859357309440527`*^9, 
   3.685935734083851*^9}, {3.6859358114440703`*^9, 3.685935864883918*^9}, {
   3.6859359477770495`*^9, 3.685936074827903*^9}, {3.685938201585147*^9, 
   3.6859382480602913`*^9}, {3.6859386847142987`*^9, 
   3.6859386902871485`*^9}, {3.685938794904948*^9, 3.685938801913557*^9}, {
   3.6859388647055616`*^9, 3.6859391826570435`*^9}, {3.685939282591569*^9, 
   3.685939361668124*^9}, {3.6859393938092546`*^9, 3.685939453162382*^9}, {
   3.685939539358158*^9, 3.685939541880886*^9}, {3.685939627381427*^9, 
   3.685939688091124*^9}, {3.685939727541782*^9, 3.6859398531402235`*^9}, {
   3.685939935438867*^9, 3.6859399931904125`*^9}, {3.685940097492096*^9, 
   3.685940120016407*^9}, 3.685940292762505*^9, {3.6859404631269507`*^9, 
   3.685940482014181*^9}, {3.685940602412209*^9, 3.6859406087521105`*^9}, {
   3.6859407035537386`*^9, 3.68594074432393*^9}, {3.685940783490595*^9, 
   3.685940805979995*^9}, {3.6859408418477755`*^9, 3.685940858366701*^9}, {
   3.685940940100796*^9, 3.685940941759778*^9}, {3.6859410580331354`*^9, 
   3.685941091047987*^9}, {3.685941138386998*^9, 3.685941138727496*^9}, {
   3.685941179406784*^9, 3.6859412722193975`*^9}, {3.6859413155274096`*^9, 
   3.6859413957932596`*^9}, {3.6859434250348797`*^9, 3.685943425611413*^9}, {
   3.685946421118318*^9, 3.6859464252859087`*^9}, {3.6860581561554394`*^9, 
   3.686058157945548*^9}, {3.6860581933003798`*^9, 3.6860582092683787`*^9}, {
   3.686058877309972*^9, 3.6860588972826395`*^9}, {3.6860591226402693`*^9, 
   3.686059140001378*^9}, {3.686059303031162*^9, 3.6860593085302114`*^9}, 
   3.6860595109916353`*^9, {3.686072012662709*^9, 3.686072050125018*^9}, 
   3.6862923801018686`*^9, {3.6863212910777864`*^9, 3.6863213396800127`*^9}, {
   3.686321570970934*^9, 3.6863215743439026`*^9}, {3.6863218277065697`*^9, 
   3.686321841913314*^9}, {3.6863221107963905`*^9, 3.686322147972232*^9}, {
   3.686322191268346*^9, 3.6863221916904984`*^9}, {3.686322237809109*^9, 
   3.6863222631645317`*^9}, {3.686322317827841*^9, 3.686322328646632*^9}, {
   3.686322402739631*^9, 3.6863224295248194`*^9}, {3.6863237198784847`*^9, 
   3.68632372527383*^9}, {3.686404463463194*^9, 3.6864044786695995`*^9}, 
   3.6864067214941244`*^9, {3.688137212287559*^9, 3.6881372183464203`*^9}, {
   3.68817675680941*^9, 3.688176761892149*^9}, 3.6887029026250496`*^9, {
   3.688828752817618*^9, 3.688828763622363*^9}, {3.6888288723014884`*^9, 
   3.68882887246793*^9}, {3.688831353685373*^9, 3.68883139519781*^9}, 
   3.68883184622442*^9, {3.690042132310853*^9, 3.6900421355143375`*^9}, {
   3.69004272303763*^9, 3.690042769693898*^9}, {3.6900487375664115`*^9, 
   3.690048748918404*^9}, 3.6900498741944685`*^9, 3.690050252503095*^9, {
   3.6900502867836623`*^9, 3.6900503228800693`*^9}, {3.6900504960113506`*^9, 
   3.6900505435521717`*^9}, {3.6904802200517573`*^9, 
   3.6904802875597024`*^9}, {3.6904803202566495`*^9, 3.690480473741865*^9}, {
   3.690480536199978*^9, 3.690480601987919*^9}, 3.6904807125619993`*^9, {
   3.690480879986307*^9, 3.690480885072831*^9}, 3.690480933328169*^9, {
   3.690481803380985*^9, 3.6904818694447145`*^9}, {3.690497997541997*^9, 
   3.6904980085606866`*^9}, {3.690498083155007*^9, 3.6904980895673265`*^9}, {
   3.690552195494785*^9, 3.6905522002139883`*^9}, {3.6913783808355618`*^9, 
   3.6913784229508667`*^9}, {3.691378531853987*^9, 3.691378559618087*^9}, {
   3.6913799312983584`*^9, 3.691379946892526*^9}, 3.6913802421867733`*^9, {
   3.691380328867268*^9, 3.6913803312523994`*^9}, {3.691380372424336*^9, 
   3.6913803891777024`*^9}, {3.691380431190031*^9, 3.691380492156994*^9}, {
   3.6913806185046935`*^9, 3.691380637516176*^9}, {3.6913806856857443`*^9, 
   3.6913807177969494`*^9}, {3.6913807909879208`*^9, 3.691380791316081*^9}, {
   3.691380829103036*^9, 3.6913808445925503`*^9}, {3.691380878717046*^9, 
   3.691380889641712*^9}, {3.691380977069975*^9, 3.6913809783201094`*^9}, {
   3.6913810779770236`*^9, 3.6913810786801753`*^9}, {3.691415201603724*^9, 
   3.691415211448531*^9}, {3.691415273282445*^9, 3.69141529772439*^9}, {
   3.6914160854234943`*^9, 3.6914160933742065`*^9}, {3.6914161435682244`*^9, 
   3.691416145223895*^9}, {3.692457068574356*^9, 3.692457097771041*^9}, {
   3.6930309771542797`*^9, 3.69303098131781*^9}, {3.6980915158884907`*^9, 
   3.698091532063632*^9}, {3.6980940540492907`*^9, 3.698094058451135*^9}, {
   3.6980947528501425`*^9, 3.698094753150405*^9}, {3.698094883079355*^9, 
   3.698094890335949*^9}, 3.698094927510917*^9, {3.698095005749666*^9, 
   3.698095027158671*^9}, 3.698095084561976*^9, {3.6980952604749174`*^9, 
   3.69809528708361*^9}, {3.698096362086219*^9, 3.698096380522223*^9}, {
   3.698096635402624*^9, 3.6980966388570223`*^9}, {3.6980967223287582`*^9, 
   3.6980967350170507`*^9}, {3.698096819068611*^9, 3.6980968565989656`*^9}, {
   3.6981593097366266`*^9, 3.698159346386836*^9}, 3.698159386705351*^9, {
   3.6981594456253824`*^9, 3.698159516589878*^9}, {3.6981602159854183`*^9, 
   3.6981602192549553`*^9}, {3.6981651012085423`*^9, 
   3.6981651577885075`*^9}, {3.698165203175996*^9, 3.6981652107841144`*^9}, {
   3.6981652689787507`*^9, 3.698165275234866*^9}, 3.698165313553744*^9, {
   3.6981653872829337`*^9, 3.698165415913951*^9}, {3.6981658268928423`*^9, 
   3.6981658483840375`*^9}, {3.6981682863486185`*^9, 3.698168288533736*^9}, {
   3.6982639023546395`*^9, 3.6982639036550837`*^9}, {3.698263978619891*^9, 
   3.69826398450587*^9}, {3.698264052423395*^9, 3.6982640534549274`*^9}, {
   3.6982645146456623`*^9, 3.6982645495120354`*^9}, {3.698264759720826*^9, 
   3.6982647807893753`*^9}, {3.6982649233889465`*^9, 
   3.6982649439327707`*^9}, {3.699810985279827*^9, 3.6998110084044743`*^9}, {
   3.699811200764338*^9, 3.699811385564688*^9}, {3.6998118144409122`*^9, 
   3.6998118148787317`*^9}, {3.700846060481764*^9, 3.7008460634068384`*^9}, {
   3.700855938304057*^9, 3.7008559551794457`*^9}, {3.700932790637437*^9, 
   3.700932790894765*^9}, {3.7009344297401457`*^9, 3.7009344302433057`*^9}, {
   3.700935324185423*^9, 3.70093534689779*^9}, {3.7009354126539993`*^9, 
   3.7009354478252425`*^9}, {3.7009355802693086`*^9, 3.700935580791936*^9}, {
   3.7009356273886547`*^9, 3.7009356665738125`*^9}, {3.7009415143900347`*^9, 
   3.700941515050504*^9}, {3.7009431360029926`*^9, 3.700943136590624*^9}, {
   3.701109867895612*^9, 3.7011099304928484`*^9}, {3.7011109218956256`*^9, 
   3.701110924910443*^9}, 3.701111891740896*^9, 3.7011119373503213`*^9, {
   3.7011123006560507`*^9, 3.7011123115671387`*^9}, {3.7011124910418463`*^9, 
   3.7011125025263615`*^9}, {3.70111255984798*^9, 3.7011125786725197`*^9}, {
   3.701916676374632*^9, 3.7019166821575165`*^9}, {3.701916715411821*^9, 
   3.7019167601281605`*^9}, {3.7020489397437887`*^9, 3.702048940459911*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eigenvalues", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.503928097550683*^9, 3.503928099975516*^9}, {
  3.504030654349873*^9, 3.5040306549409733`*^9}, {3.568127373491021*^9, 
  3.568127376717606*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HillSG", "[", 
    RowBox[{"F_", ",", "Fx_", ",", "Ft_", ",", "mu_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "c2", ",", "c1", ",", "c0", ",", "f11", ",", "f12", ",", "zz", ",", 
       "one", ",", "f02", ",", "f01", ",", "t", ",", "A", ",", "Aold", ",", 
       "L", ",", "P", ",", "dftx", ",", "fun", ",", "f10", ",", "f03", ",", 
       "g00", ",", "g11", ",", "g02", ",", "g03"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Off", "[", 
       RowBox[{"General", "::", "unfl"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Off", "[", 
       RowBox[{"General", "::", "ovfl"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"L", " ", "=", " ", "Pi"}], ";", "\[IndentingNewLine]", 
      RowBox[{"P", " ", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "[", "x_", "]"}], " ", ":=", " ", 
       RowBox[{"Tan", "[", 
        RowBox[{"x", "/", "2"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"map", " ", "the", " ", 
        RowBox[{"interval", " ", "[", 
         RowBox[{
          RowBox[{"-", "L"}], ",", "L"}], "]"}], " ", "to", " ", "R"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"zz", "[", "x_", "]"}], ":=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"Length", "[", "x", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"f11", "[", "x_", "]"}], ":=", " ", 
         RowBox[{"2", "I", " ", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"x", "/", "2"}], "]"}], "^", "2"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"f12", "[", "x_", "]"}], ":=", 
         RowBox[{
          RowBox[{"-", "2"}], "I", " ", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"x", "/", "2"}], "]"}], "^", "2"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dftx", "[", "x_", "]"}], "=", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"F", "[", 
            RowBox[{"t", "[", "x", "]"}], "]"}], ",", "x"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"f02", "[", "x_", "]"}], ":=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "I"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"dftx", "[", "x", "]"}]}], "/", "2"}], ")"}]}], "/.", 
          RowBox[{
           RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"f01", "[", "x_", "]"}], ":=", " ", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dftx", "[", "x", "]"}], "/", "2"}], ")"}]}], "/.", 
          RowBox[{
           RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fun", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zz", ",", "f11"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"f02", ",", "zz"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"f01", ",", "zz"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zz", ",", "f12"}], "}"}]}], "}"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Aold", "=", " ", 
         RowBox[{"Hill", "[", 
          RowBox[{"mu", ",", "L", ",", "n", ",", "P", ",", "fun"}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"one", "[", "x_", "]"}], ":=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"-", "1."}], ",", 
         RowBox[{"Length", "[", "x", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f10", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"-", "4"}], "*", "I", "*", "2", " ", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"x", "/", "2"}], "]"}], "^", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f01", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"-", "I"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Fx", "[", 
           RowBox[{"t", "[", "x", "]"}], "]"}], "+", 
          RowBox[{"Ft", "[", 
           RowBox[{"t", "[", "x", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"f01", "[", "x", "]"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f02", "[", "x_", "]"}], ":=", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"F", "[", 
          RowBox[{"t", "[", "x", "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f03", "[", "x_", "]"}], ":=", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"F", "[", 
          RowBox[{"t", "[", "x", "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g00", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"-", "I"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Fx", "[", 
           RowBox[{"t", "[", "x", "]"}], "]"}], "+", 
          RowBox[{"Ft", "[", 
           RowBox[{"t", "[", "x", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g11", "[", "x_", "]"}], ":=", 
       RowBox[{"4", "*", "I", "*", "2", " ", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"x", "/", "2"}], "]"}], "^", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g02", "[", "x_", "]"}], ":=", 
       RowBox[{"Sin", "[", 
        RowBox[{"F", "[", 
         RowBox[{"t", "[", "x", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g03", "[", "x_", "]"}], ":=", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"F", "[", 
          RowBox[{"t", "[", "x", "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fun", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"zz", ",", "f10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"f01", ",", "zz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"f02", ",", "zz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"f03", ",", "zz"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"g00", ",", "zz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zz", ",", "g11"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"g02", ",", "zz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"g03", ",", "zz"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"one", ",", "zz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zz", ",", "zz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zz", ",", "zz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zz", ",", "zz"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"zz", ",", "zz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"one", ",", "zz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zz", ",", "zz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zz", ",", "zz"}], "}"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", "=", " ", 
       RowBox[{"Hill", "[", 
        RowBox[{"mu", ",", "L", ",", "n", ",", "P", ",", "fun"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"On", "[", 
       RowBox[{"General", "::", "unfl"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"On", "[", 
       RowBox[{"General", "::", "ovfl"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"Chop", "[", 
        RowBox[{"A", ",", "$MachineEpsilon"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LocatePolesSG", "[", 
    RowBox[{"F_", ",", "Fx_", ",", "Ft_", ",", "mu_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eval", ",", "s", ",", "i", ",", "sys", ",", "vecs"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Off", "[", 
       RowBox[{"General", "::", "unfl"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"eval", "=", 
       RowBox[{"HillSG", "[", 
        RowBox[{"F", ",", "Fx", ",", "Ft", ",", "mu", ",", "n"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "eval", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"eval", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "2"}], ")"}]}]}], "&&", " ", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"eval", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "<", "30"}]}], ",", 
           "    ", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "this", " ", "first", " ", "condition", " ", "exludes", " ", 
              "the", " ", "continuous", " ", "spectrum", 
              RowBox[{"(", 
               RowBox[{
               "they", " ", "lie", " ", "on", " ", "the", " ", "real", " ", 
                "axis"}], ")"}], " ", "the", " ", "second", " ", "condition", 
              " ", "is", " ", "not", " ", "very", " ", "clear"}], ",", " ", 
             RowBox[{
             "maybe", " ", "due", " ", "to", " ", "relative", " ", "error"}], 
             ",", " ", 
             RowBox[{
             "some", " ", "spectra", " ", "on", " ", "the", " ", "real", " ", 
              "axis", " ", "with", " ", "large", " ", "magnitude", " ", "may",
               " ", "have", " ", "a", " ", "larger", " ", "Im", " ", 
              "part"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"s", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"s", ",", 
               RowBox[{"{", 
                RowBox[{"eval", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"On", "[", 
       RowBox[{"General", "::", "unfl"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Chop", "[", 
       RowBox[{"s", ",", "$MachineEpsilon"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.503864765345394*^9, 3.503864805342846*^9}, {
   3.50386734288988*^9, 3.503867354117487*^9}, {3.503927760898873*^9, 
   3.503927788744951*^9}, {3.503927896065843*^9, 3.503927898017088*^9}, {
   3.503927946305841*^9, 3.503927987465645*^9}, {3.503928052874394*^9, 
   3.503928083824047*^9}, {3.503928147881987*^9, 3.503928148234082*^9}, {
   3.503928256325563*^9, 3.503928300122334*^9}, {3.503928344716576*^9, 
   3.503928374380585*^9}, {3.50392844123773*^9, 3.503928460781448*^9}, 
   3.503928811980692*^9, {3.503929274135363*^9, 3.503929285314468*^9}, {
   3.503929315402057*^9, 3.503929319956047*^9}, {3.503929410566998*^9, 
   3.503929421191896*^9}, {3.503929577459712*^9, 3.503929582154504*^9}, {
   3.503929719644224*^9, 3.503929721700133*^9}, {3.503929866254088*^9, 
   3.503929911131696*^9}, {3.503930134680891*^9, 3.503930136866754*^9}, {
   3.503930189879069*^9, 3.50393023334754*^9}, {3.503930273900549*^9, 
   3.503930293646057*^9}, {3.503930944205041*^9, 3.503931066589187*^9}, {
   3.503931179513111*^9, 3.503931190473869*^9}, {3.503931261887096*^9, 
   3.503931274581136*^9}, {3.503931328583484*^9, 3.503931370004759*^9}, {
   3.503931407748326*^9, 3.503931407914923*^9}, {3.503933307782749*^9, 
   3.503933338694513*^9}, {3.503933407486908*^9, 3.503933415562467*^9}, {
   3.503937036128636*^9, 3.503937097560886*^9}, {3.503937144941339*^9, 
   3.5039372344975*^9}, {3.503942000708616*^9, 3.503942006005069*^9}, {
   3.504021886951573*^9, 3.504021908326655*^9}, 3.504022004000711*^9, {
   3.504026086567231*^9, 3.5040260878016148`*^9}, {3.50403068418861*^9, 
   3.504030757608275*^9}, {3.504030876667343*^9, 3.5040308791785603`*^9}, {
   3.504030997464014*^9, 3.504031027125536*^9}, 3.504038920402371*^9, 
   3.504209954034*^9, {3.504288326676*^9, 3.5042883269779997`*^9}, {
   3.504288441027*^9, 3.504288477814*^9}, {3.504289857642*^9, 
   3.504289858402*^9}, {3.5681261526192427`*^9, 3.568126187175927*^9}, {
   3.568126336581677*^9, 3.568126367368129*^9}, {3.568126820904642*^9, 
   3.568126826552787*^9}, {3.6683472616375494`*^9, 3.6683473067534323`*^9}, {
   3.668347731026457*^9, 3.668347767874325*^9}, {3.6761316269783177`*^9, 
   3.6761316372095327`*^9}, {3.6846819625875816`*^9, 3.684681969584423*^9}, {
   3.684682077705347*^9, 3.684682089196988*^9}, {3.6846917855468826`*^9, 
   3.6846918265949097`*^9}, {3.6846932920152206`*^9, 
   3.6846933094708977`*^9}, {3.684693385436449*^9, 3.68469339005291*^9}, {
   3.6846954262792835`*^9, 3.6846954390296926`*^9}, {3.684695685500759*^9, 
   3.6846956916047287`*^9}, {3.684695779536955*^9, 3.6846957824081535`*^9}, {
   3.68469587190829*^9, 3.6846958893461494`*^9}, {3.6846959327959166`*^9, 
   3.6846959348101625`*^9}, {3.684696106901103*^9, 3.6846961178235445`*^9}, {
   3.684696207047325*^9, 3.684696217614149*^9}, {3.6847639232187357`*^9, 
   3.684763929328498*^9}, {3.6847639720607986`*^9, 3.6847639754078383`*^9}, {
   3.684764009397232*^9, 3.6847640097887955`*^9}, {3.684764426108387*^9, 
   3.6847644447333403`*^9}, {3.6847648756024647`*^9, 3.684764880110841*^9}, {
   3.684764960774482*^9, 3.684764961070366*^9}, {3.6847677148829317`*^9, 
   3.684767735845681*^9}, {3.6847689932970686`*^9, 3.6847690355383697`*^9}, {
   3.6847690689492116`*^9, 3.6847690701905165`*^9}, {3.684769127699468*^9, 
   3.6847691791512623`*^9}, {3.684769256011648*^9, 3.6847692988996954`*^9}, {
   3.6847695427571573`*^9, 3.6847695430358973`*^9}, {3.684769604781089*^9, 
   3.684769607392064*^9}, 3.684769657442124*^9, {3.684769689353984*^9, 
   3.6847697019765487`*^9}, {3.685106785687521*^9, 3.6851067865097003`*^9}, {
   3.6865802702800813`*^9, 3.686580378959036*^9}, {3.686581000910673*^9, 
   3.686581007374859*^9}, 3.686581190863744*^9, {3.686582680101281*^9, 
   3.686582711296259*^9}, 3.686593732436596*^9, {3.6865940072857184`*^9, 
   3.686594037229332*^9}, {3.6865948077554836`*^9, 3.6865949346278095`*^9}, {
   3.686595059394538*^9, 3.6865952236753263`*^9}, {3.686595530628451*^9, 
   3.6865955383951006`*^9}, {3.6865955803336053`*^9, 
   3.6865956137965765`*^9}, {3.6865961359294887`*^9, 3.686596330645177*^9}, {
   3.6865963733186364`*^9, 3.68659640415763*^9}, {3.686596449626522*^9, 
   3.6865964670899725`*^9}, {3.6865965831134353`*^9, 
   3.6865965892988806`*^9}, {3.686596621906578*^9, 3.686596675771787*^9}, {
   3.686596781125901*^9, 3.6865967813755655`*^9}, {3.6865969056008544`*^9, 
   3.686596919580021*^9}, {3.6865971116958165`*^9, 3.6865971222348375`*^9}, 
   3.6866179036636953`*^9, {3.686618407280105*^9, 3.686618411233678*^9}, {
   3.686618564828255*^9, 3.6866185974723673`*^9}, {3.6866186383517413`*^9, 
   3.686618647165143*^9}, {3.6866222623144875`*^9, 3.6866222651585426`*^9}, {
   3.6866223963635173`*^9, 3.6866223973948774`*^9}, {3.686622591775059*^9, 
   3.6866226015104733`*^9}, 3.686622894838748*^9, {3.6866229330403237`*^9, 
   3.6866229579492364`*^9}, {3.686623003735386*^9, 3.6866230043447847`*^9}, {
   3.6866261313881197`*^9, 3.6866261379669466`*^9}, {3.686668190629855*^9, 
   3.6866682024162893`*^9}, 3.6869013134399676`*^9, 3.686901496489854*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jump Functions", "Section",
 CellChangeTimes->{{3.568128904921782*^9, 3.56812890695053*^9}}],

Cell[CellGroupData[{

Cell["Unscaled Functions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5408983275643997`*^9, 3.5408983375383997`*^9}, {
  3.568128918926874*^9, 3.568128920316318*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", " ", 
    RowBox[{"Piecewise", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"z", "==", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{"I", "/", "4"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"z", "+", 
               RowBox[{"1", "/", "z"}]}], ")"}], "t"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"z", "-", 
               RowBox[{"1", "/", "z"}]}], ")"}], "x"}]}], " ", ")"}]}], ",", 
         RowBox[{"z", "\[NotEqual]", "0"}]}], "}"}]}], "}"}], "]"}]}], ";"}], 
  "    "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exppt", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"z", "==", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"\[Theta]", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}], ",", 
        RowBox[{"z", "\[NotEqual]", "0"}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"expmt", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
    RowBox[{"Piecewise", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"z", "==", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "]"}], ",", 
         RowBox[{"z", "\[NotEqual]", "0"}]}], "}"}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rb", "[", "k_", "]"}], ":=", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"r", "[", 
     RowBox[{"cc", "[", "k", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rbsamp", "[", "k_", "]"}], ":=", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"rsamp", "[", 
     RowBox[{"cc", "[", "k", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Tau]samp", "[", "k_", "]"}], ":=", 
    RowBox[{"1", "+", " ", 
     RowBox[{
      RowBox[{"rsamp", "[", "k", "]"}], 
      RowBox[{"cc", "[", 
       RowBox[{"rsamp", "[", 
        RowBox[{"cc", "[", "k", "]"}], "]"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {
       RowBox[{
        FractionBox[
         RowBox[{"r", "[", "k", "]"}], 
         RowBox[{"\[Tau]", "[", "k", "]"}]], 
        RowBox[{
         RowBox[{"exppt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Lsamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {
        RowBox[{
         FractionBox[
          RowBox[{"rsamp", "[", "k", "]"}], 
          RowBox[{"\[Tau]samp", "[", "k", "]"}]], 
         RowBox[{
          RowBox[{"exppt", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Lin", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"r", "[", "k", "]"}], 
          RowBox[{"\[Tau]", "[", "k", "]"}]]}], 
        RowBox[{
         RowBox[{"exppt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Linsamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"rsamp", "[", "k", "]"}], 
           RowBox[{"\[Tau]samp", "[", "k", "]"}]]}], 
         RowBox[{
          RowBox[{"exppt", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"U", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        FractionBox[
         RowBox[{"rb", "[", "k", "]"}], 
         RowBox[{"\[Tau]", "[", "k", "]"}]], 
        RowBox[{
         RowBox[{"expmt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Uin", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"rb", "[", "k", "]"}], 
          RowBox[{"\[Tau]", "[", "k", "]"}]]}], 
        RowBox[{
         RowBox[{"expmt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Usamp", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        FractionBox[
         RowBox[{"rbsamp", "[", "k", "]"}], 
         RowBox[{"\[Tau]samp", "[", "k", "]"}]], 
        RowBox[{
         RowBox[{"expmt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Uinsamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"rbsamp", "[", "k", "]"}], 
           RowBox[{"\[Tau]samp", "[", "k", "]"}]]}], 
         RowBox[{
          RowBox[{"expmt", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}]},
       {"0", "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DD", "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"\[Tau]", "[", "k", "]"}], "0"},
       {"0", 
        RowBox[{"1", "/", 
         RowBox[{"\[Tau]", "[", "k", "]"}]}]}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DDsamp", "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"\[Tau]samp", "[", "k", "]"}], "0"},
       {"0", 
        RowBox[{"1", "/", 
         RowBox[{"\[Tau]samp", "[", "k", "]"}]}]}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"r", "[", "z", "]"}], 
         RowBox[{"rb", "[", "z", "]"}]}]}], 
       RowBox[{
        RowBox[{"rb", "[", "z", "]"}], 
        RowBox[{
         RowBox[{"expmt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}]},
      {
       RowBox[{
        RowBox[{"r", "[", "z", "]"}], " ", 
        RowBox[{
         RowBox[{"exppt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"G", "[", 
      RowBox[{"_", ",", "_"}], "]"}], "[", 
     RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1.", "0"},
       {"0", "1."}
      }], ")"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", "the", " ", "samp"}], ",", " ", 
    RowBox[{
    "we", " ", "actually", " ", "need", " ", "abs", "\[IndentingNewLine]", 
     "   ", "nope", "  ", "the", " ", "above", " ", "is", " ", "wrong"}], ",",
     "  ", 
    RowBox[{
    "it", " ", "was", " ", "because", " ", "exppt", " ", "and", " ", "expmt", 
     " ", "were", " ", "incrrectly", " ", "set", " ", "to", " ", "zero"}]}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Gsamp", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"rsamp", "[", "z", "]"}], 
         RowBox[{"rbsamp", "[", "z", "]"}]}]}], 
       RowBox[{
        RowBox[{"rbsamp", "[", "z", "]"}], 
        RowBox[{
         RowBox[{"expmt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}]},
      {
       RowBox[{
        RowBox[{"rsamp", "[", "z", "]"}], "  ", 
        RowBox[{
         RowBox[{"exppt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Gsamp", "[", 
      RowBox[{"_", ",", "_"}], "]"}], "[", 
     RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1.", "0"},
       {"0", "1."}
      }], ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"M", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        RowBox[{"rb", "[", "k", "]"}], " ", 
        RowBox[{
         RowBox[{"expmt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Msamp", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        RowBox[{"rbsamp", "[", "k", "]"}], " ", 
        RowBox[{
         RowBox[{"expmt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Minv", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"rb", "[", "k", "]"}]}], " ", 
        RowBox[{
         RowBox[{"expmt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Minvsamp", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"rbsamp", "[", "k", "]"}]}], " ", 
        RowBox[{
         RowBox[{"expmt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"P", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {
       RowBox[{
        RowBox[{"r", "[", "k", "]"}], " ", 
        RowBox[{
         RowBox[{"exppt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Psamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {
        RowBox[{
         RowBox[{"rsamp", "[", "k", "]"}], " ", 
         RowBox[{
          RowBox[{"exppt", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"qq", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "a", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"c", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"Re", "[", 
               RowBox[{
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"x", ",", "t"}], "]"}], "[", 
                RowBox[{"a", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}]}], ">", 
            "expconst"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"out", " ", "=", " ", 
             RowBox[{"out", "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"k", "-", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"k", "-", 
                 RowBox[{"Conjugate", "[", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ")"}]}]}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "out"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Q", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        RowBox[{"qq", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "0"},
      {"0", 
       RowBox[{"1", "/", 
        RowBox[{
         RowBox[{"qq", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Q", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", 
    RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1.", "0"},
      {"0", "1."}
     }], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.538103142394384*^9, 3.538103151534226*^9}, {
   3.5381035800010853`*^9, 3.5381035806070843`*^9}, {3.540653533861*^9, 
   3.540653534101*^9}, {3.5406547841210003`*^9, 3.540654804311*^9}, {
   3.5406548650150003`*^9, 3.540654883401*^9}, {3.5406583132382*^9, 
   3.5406583318182*^9}, {3.5406593163606*^9, 3.5406593424706*^9}, {
   3.5406606785154*^9, 3.5406606829554*^9}, {3.540670035786598*^9, 
   3.540670045469647*^9}, {3.5406701523856287`*^9, 3.540670159109951*^9}, {
   3.540671043884227*^9, 3.5406710445151052`*^9}, {3.54067107622948*^9, 
   3.540671117438383*^9}, 3.540671223981215*^9, 3.540673675932254*^9, {
   3.5406742109124002`*^9, 3.5406742112953997`*^9}, {3.5406777028814*^9, 
   3.5406777049323997`*^9}, {3.5406826023554*^9, 3.5406826068993998`*^9}, {
   3.5406828924653997`*^9, 3.5406828948314*^9}, {3.5406831061644*^9, 
   3.5406831144644003`*^9}, {3.5406844599924*^9, 3.5406844614054003`*^9}, {
   3.5406847746944*^9, 3.5406847750914*^9}, {3.5406849669924*^9, 
   3.5406849737824*^9}, {3.5406851745424*^9, 3.5406852291823997`*^9}, {
   3.5406853996924*^9, 3.5406853998624*^9}, 3.5406876104944*^9, {
   3.5406888923224*^9, 3.5406889113124*^9}, {3.5407250148524*^9, 
   3.5407250177324*^9}, {3.5407255652974*^9, 3.5407255687424*^9}, {
   3.5407264058993998`*^9, 3.5407264153334*^9}, {3.5407270816303997`*^9, 
   3.5407270841644*^9}, {3.5407272503754*^9, 3.5407272625214*^9}, {
   3.5407277902693996`*^9, 3.5407277906574*^9}, {3.5407280626984*^9, 
   3.5407280632244*^9}, {3.540732091156747*^9, 3.540732094732853*^9}, {
   3.5407337077895193`*^9, 3.540733708610265*^9}, {3.540734314953412*^9, 
   3.540734315469853*^9}, {3.540734447769846*^9, 3.540734448600122*^9}, {
   3.5407364063724413`*^9, 3.5407364098191147`*^9}, {3.5407369996439257`*^9, 
   3.54073700378605*^9}, {3.540737269754858*^9, 3.540737270296258*^9}, {
   3.5407374577807903`*^9, 3.540737460562327*^9}, 3.5407388991890717`*^9, {
   3.540739981122607*^9, 3.540739982269462*^9}, {3.540740493804627*^9, 
   3.540740495873988*^9}, {3.540740792568321*^9, 3.540740792845584*^9}, {
   3.540741429871428*^9, 3.540741430139724*^9}, {3.540743857872079*^9, 
   3.5407438622771*^9}, {3.540749237001852*^9, 3.5407492383893623`*^9}, {
   3.5407608990193996`*^9, 3.5407609003594*^9}, {3.5407636848574*^9, 
   3.5407637029354*^9}, {3.5407637497794*^9, 3.5407637906194*^9}, {
   3.5407639569974003`*^9, 3.5407639572774*^9}, 3.5407685188574*^9, {
   3.5407690527953997`*^9, 3.5407690690114*^9}, {3.540839541133526*^9, 
   3.540839547433312*^9}, {3.5409029240854*^9, 3.5409029383283997`*^9}, 
   3.5409035117384*^9, 3.5409416746544*^9, 3.5656171862981997`*^9, {
   3.5656174193571997`*^9, 3.5656174476022*^9}, {3.5656175091342*^9, 
   3.5656175348802*^9}, {3.5656175759962*^9, 3.5656176103392*^9}, {
   3.5656176410592003`*^9, 3.5656176662782*^9}, {3.5656177086092*^9, 
   3.5656177351282*^9}, {3.5656204709592*^9, 3.5656205127052*^9}, {
   3.5656212498292*^9, 3.5656214052762003`*^9}, {3.5656411683152*^9, 
   3.5656411980062*^9}, {3.5656586528082*^9, 3.5656587202482*^9}, {
   3.565754330008767*^9, 3.565754333067934*^9}, {3.5681288606726007`*^9, 
   3.568128864037929*^9}, {3.568129172366681*^9, 3.568129210978828*^9}, {
   3.568129281093484*^9, 3.568129290380556*^9}, {3.568129652490979*^9, 
   3.568129663654998*^9}, {3.56813263902489*^9, 3.568132648010124*^9}, {
   3.568132691574448*^9, 3.56813270059894*^9}, {3.5681455250180607`*^9, 
   3.5681455292247887`*^9}, {3.5681471446438637`*^9, 3.568147147953083*^9}, {
   3.568147241915513*^9, 3.568147324679017*^9}, {3.568147364300024*^9, 
   3.5681473662966757`*^9}, {3.568147541341443*^9, 3.568147544281726*^9}, {
   3.568147752436235*^9, 3.568147766837874*^9}, {3.5681487126240683`*^9, 
   3.568148725181775*^9}, {3.568332505130286*^9, 3.568332564706992*^9}, {
   3.568333948645219*^9, 3.568334002967908*^9}, {3.6683479663708887`*^9, 
   3.6683479694440937`*^9}, {3.668864471451964*^9, 3.668864489522998*^9}, {
   3.6688792728774333`*^9, 3.6688792859396563`*^9}, {3.668879335437944*^9, 
   3.6688793835020294`*^9}, {3.668879936825288*^9, 3.6688799437099004`*^9}, {
   3.6688823740056543`*^9, 3.6688823786106625`*^9}, {3.66888337822205*^9, 
   3.668883431321746*^9}, {3.668883491254853*^9, 3.6688835207967052`*^9}, {
   3.6763929026780457`*^9, 3.6763929187456064`*^9}, {3.676999315810422*^9, 
   3.676999358592221*^9}, {3.6769997558999014`*^9, 3.676999756363134*^9}, {
   3.677262562550049*^9, 3.677262598731282*^9}, {3.6772631289424396`*^9, 
   3.677263130880595*^9}, {3.6772636170335546`*^9, 3.677263618501459*^9}, {
   3.677418415177307*^9, 3.677418427961274*^9}, {3.6774187409336405`*^9, 
   3.6774187711109037`*^9}, {3.678002045597785*^9, 3.67800204892966*^9}, {
   3.6783915348983564`*^9, 3.6783915369587727`*^9}, {3.6848638567745447`*^9, 
   3.6848639128145585`*^9}, {3.685107876657617*^9, 3.685107901686156*^9}, {
   3.685109911072471*^9, 3.6851099120009766`*^9}, {3.6851100009414454`*^9, 
   3.6851100150499673`*^9}, {3.685110108907548*^9, 3.685110134508625*^9}, {
   3.6856674960661116`*^9, 3.685667498675724*^9}, {3.68566882435998*^9, 
   3.6856688279668484`*^9}, {3.6859422706007075`*^9, 
   3.6859423127702956`*^9}, {3.685946969708565*^9, 3.685946970411332*^9}, {
   3.686288887270957*^9, 3.686288945288221*^9}, {3.6899631649564195`*^9, 
   3.689963364887173*^9}, {3.692470739157938*^9, 3.692470748062252*^9}, {
   3.6930322827661886`*^9, 3.6930322865835*^9}, 3.693033008100713*^9, 
   3.693033320307526*^9, {3.7009441229068995`*^9, 3.7009441280776553`*^9}, {
   3.700945108029228*^9, 3.7009451114425373`*^9}, {3.7009459065333266`*^9, 
   3.7009459917785687`*^9}, {3.701017883990122*^9, 3.7010179358996925`*^9}, {
   3.7010184979229593`*^9, 3.701018498813701*^9}, {3.7010186724506807`*^9, 
   3.701018696148509*^9}, {3.7010189426140203`*^9, 3.7010189428796515`*^9}, {
   3.7010190386071215`*^9, 3.701019069429824*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region 0: Undeformed", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.538443201592167*^9, 3.538443212095222*^9}, {
   3.5656156095022*^9, 3.5656156113522*^9}, 3.5656208942292*^9, {
   3.689900677555787*^9, 3.6899006862758226`*^9}, {3.6899008005683784`*^9, 
   3.68990082339987*^9}, {3.6899010011546803`*^9, 3.68990102702159*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"J", "[", "0", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"G", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "el"}], ",", 
          RowBox[{"-", "0.3"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.3"}], ",", "0."}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.3"}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", "el"}], "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"bigN", ",", "bigN", ",", "bigN", ",", "bigN"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Jsamp", "[", "0", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Gsamp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Gsamp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Gsamp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Gsamp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "el"}], ",", 
          RowBox[{"-", "0.3"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.3"}], ",", "0."}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.3"}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", "el"}], "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"bigN", ",", "bigN", ",", "bigN", ",", "bigN"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Jadapt", "[", "0", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Adapt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Jsamp", "[", "0", "]"}], "[", 
       RowBox[{"x", ",", "t"}], "]"}], ",", "globalTol"}], "]"}], "[", 
    RowBox[{
     RowBox[{"J", "[", "0", "]"}], "[", 
     RowBox[{"x", ",", "t"}], "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5406576785462*^9, 3.5406577161661997`*^9}, {
   3.5406582201982*^9, 3.5406582273082*^9}, 3.5406586749382*^9, 
   3.5407609243294*^9, {3.5408422052614202`*^9, 3.540842205632593*^9}, {
   3.540842429716239*^9, 3.540842429846467*^9}, {3.5409332732904*^9, 
   3.5409333148454*^9}, {3.541861619785755*^9, 3.541861623452838*^9}, {
   3.541861656327001*^9, 3.541861658902041*^9}, {3.5423735388424*^9, 
   3.5423735413424*^9}, {3.5424025499314003`*^9, 3.5424025521113997`*^9}, {
   3.5656156244642*^9, 3.5656156262852*^9}, {3.5656183001152*^9, 
   3.5656183043241997`*^9}, {3.5656205355512*^9, 3.5656205799202003`*^9}, {
   3.5656206584592*^9, 3.5656206776342*^9}, {3.5656208891191998`*^9, 
   3.5656208914672003`*^9}, {3.5656305467581997`*^9, 3.5656305490722*^9}, {
   3.5657106489052*^9, 3.5657106655822*^9}, {3.6688646030924935`*^9, 
   3.6688646086348104`*^9}, {3.6772627143488073`*^9, 3.677262720583387*^9}, {
   3.677608209671382*^9, 3.6776082151720424`*^9}, 3.6779991473028817`*^9, {
   3.677999184557966*^9, 3.67799918992822*^9}, {3.678001881442211*^9, 
   3.6780018874201045`*^9}, {3.678002011618438*^9, 3.678002025640688*^9}, {
   3.6783914930473757`*^9, 3.678391496735267*^9}, {3.68566798623199*^9, 
   3.6856681535216208`*^9}, {3.6859517281033816`*^9, 3.685951758126738*^9}, {
   3.6859783905449715`*^9, 3.6859784061135683`*^9}, {3.686288794679803*^9, 
   3.6862888619476275`*^9}, {3.6862891725226007`*^9, 
   3.6862891728504725`*^9}, {3.6864077369109006`*^9, 3.686407792555849*^9}, {
   3.6864089010727043`*^9, 3.6864089014266453`*^9}, {3.6864092530736113`*^9, 
   3.686409260567524*^9}, {3.6868004564582925`*^9, 3.686800502203461*^9}, {
   3.68680148632432*^9, 3.686801526310995*^9}, {3.688091337146123*^9, 
   3.6880913409543257`*^9}, {3.6894527277203636`*^9, 3.689452728519986*^9}, {
   3.6894527608570547`*^9, 3.689452769821656*^9}, {3.6894528252045593`*^9, 
   3.689452856125573*^9}, {3.689453022989581*^9, 3.6894530388147726`*^9}, {
   3.6894531054930983`*^9, 3.689453193812871*^9}, {3.689453905303151*^9, 
   3.6894539600585933`*^9}, 3.6894544257258134`*^9, {3.689899862992543*^9, 
   3.689899884135343*^9}, {3.6898999255974817`*^9, 3.689900131781048*^9}, 
   3.689900784742346*^9, {3.6899010027225685`*^9, 3.689901004989668*^9}, {
   3.689901036315647*^9, 3.689901046310915*^9}, 3.689963371630931*^9, {
   3.6899657455348287`*^9, 3.6899657522082577`*^9}, {3.7005064206975317`*^9, 
   3.70050642809422*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region 1: Outside the light cone, x>=t   ( =X= shape deform)", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.538443201592167*^9, 3.538443212095222*^9}, {
   3.5656156095022*^9, 3.5656156113522*^9}, 3.5656208942292*^9, {
   3.689900677555787*^9, 3.6899006862758226`*^9}, {3.6899008005683784`*^9, 
   3.689900839626792*^9}, 3.6899010108355513`*^9, 3.6899012719306927`*^9, {
   3.690038081875242*^9, 3.6900380998043575`*^9}, {3.7005064486353936`*^9, 
   3.700506491603101*^9}, 3.7005066215243626`*^9, {3.700849291251309*^9, 
   3.7008492938718653`*^9}, {3.7010191868313985`*^9, 3.701019198286107*^9}, {
   3.70102054477201*^9, 3.701020547272273*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Using", " ", "Arc"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "problems", " ", "with", " ", "center", " ", "and", " ", "radius", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"J", "[", "1", "]"}], "[", 
        RowBox[{"x_", ",", "t_"}], "]"}]}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"P", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"P", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"P", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"P", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "el"}], "-", 
              RowBox[{"I", "*", "\[Nu]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "\[Nu]"}], "-", 
              RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
          RowBox[{"Arc", "[", 
           RowBox[{
            RowBox[{"0", "-", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", "\[Nu]", ",", 
            RowBox[{"{", " ", 
             RowBox[{"\[Pi]", ",", "  ", 
              RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Arc", "[", 
           RowBox[{
            RowBox[{"0", "-", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", "\[Nu]", ",", 
            RowBox[{"{", "  ", 
             RowBox[{
              RowBox[{"\[Pi]", "/", "2"}], ",", "0"}], "}"}]}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Nu]", "-", 
              RowBox[{"I", "*", "\[Nu]"}]}], ",", 
             RowBox[{"el", "-", 
              RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "el"}], "+", 
              RowBox[{"I", "*", "\[Nu]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "\[Nu]"}], "+", 
              RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
          RowBox[{"Arc", "[", 
           RowBox[{
            RowBox[{"0", "+", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", "\[Nu]", ",", 
            RowBox[{"{", " ", 
             RowBox[{"\[Pi]", ",", " ", 
              RowBox[{"\[Pi]", "+", " ", 
               RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Arc", "[", 
           RowBox[{
            RowBox[{"0", "+", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", "\[Nu]", ",", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"\[Pi]", "+", " ", 
               RowBox[{"\[Pi]", "/", "2"}]}], ",", " ", 
              RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Nu]", "+", 
              RowBox[{"I", "*", "\[Nu]"}]}], ",", 
             RowBox[{"el", "+", 
              RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"bigN", ",", 
          RowBox[{"smallN", "*", "3"}], ",", 
          RowBox[{"smallN", "*", "3"}], ",", "bigN", ",", "bigN", ",", 
          RowBox[{"smallN", "*", "3"}], ",", 
          RowBox[{"smallN", "*", "3"}], ",", "bigN"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Jsamp", "[", "1", "]"}], "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Msamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Msamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Msamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Msamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Psamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Psamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Psamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Psamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "el"}], "-", 
              RowBox[{"I", "*", "\[Nu]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "\[Nu]"}], "-", 
              RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
          RowBox[{"Arc", "[", 
           RowBox[{
            RowBox[{"0", "-", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", "\[Nu]", ",", 
            RowBox[{"{", " ", 
             RowBox[{"\[Pi]", ",", "  ", 
              RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Arc", "[", 
           RowBox[{
            RowBox[{"0", "-", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", "\[Nu]", ",", 
            RowBox[{"{", "  ", 
             RowBox[{
              RowBox[{"\[Pi]", "/", "2"}], ",", "0"}], "}"}]}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Nu]", "-", 
              RowBox[{"I", "*", "\[Nu]"}]}], ",", 
             RowBox[{"el", "-", 
              RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "el"}], "+", 
              RowBox[{"I", "*", "\[Nu]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "\[Nu]"}], "+", 
              RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
          RowBox[{"Arc", "[", 
           RowBox[{
            RowBox[{"0", "+", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", "\[Nu]", ",", 
            RowBox[{"{", " ", 
             RowBox[{"\[Pi]", ",", " ", 
              RowBox[{"\[Pi]", "+", " ", 
               RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Arc", "[", 
           RowBox[{
            RowBox[{"0", "+", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", "\[Nu]", ",", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"\[Pi]", "+", " ", 
               RowBox[{"\[Pi]", "/", "2"}]}], ",", " ", 
              RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Nu]", "+", 
              RowBox[{"I", "*", "\[Nu]"}]}], ",", 
             RowBox[{"el", "+", 
              RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"bigN", ",", 
          RowBox[{"smallN", "*", "3"}], ",", 
          RowBox[{"smallN", "*", "3"}], ",", "bigN", ",", "bigN", ",", 
          RowBox[{"smallN", "*", "3"}], ",", 
          RowBox[{"smallN", "*", "3"}], ",", "bigN"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Jadapt", "[", "1", "]"}], "[", 
         RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Adapt", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Jsamp", "[", "1", "]"}], "[", 
            RowBox[{"x", ",", "t"}], "]"}], ",", "globalTol"}], "]"}], "[", 
         RowBox[{
          RowBox[{"J", "[", "1", "]"}], "[", 
          RowBox[{"x", ",", "t"}], "]"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Jadapt", "[", "1", "]"}], "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], ":=", " ", 
      RowBox[{
       RowBox[{"J", "[", "1", "]"}], "[", 
       RowBox[{"x", ",", "t"}], "]"}]}], ";"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Using", " ", "Line"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nu1", "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"8", "\[Nu]"}], ")"}], "^", "2"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"8", "\[Nu]"}], ")"}]}], "-", "\[Nu]"}], ")"}], "^", 
        "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"J", "[", "1", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "el"}], "-", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "nu1"}], "-", 
             RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "nu1"}], "-", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", "0"}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", " ", 
           RowBox[{"0", ",", 
            RowBox[{"nu1", "-", 
             RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nu1", "-", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", 
            RowBox[{"el", "-", 
             RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "el"}], "+", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "nu1"}], "+", 
             RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "nu1"}], "+", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", "0"}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", " ", 
           RowBox[{"0", ",", 
            RowBox[{"nu1", "+", 
             RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nu1", "+", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", 
            RowBox[{"el", "+", 
             RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "bigN", ",", "bigN", ",", "bigN", ",", "bigN", ",", "bigN", ",", 
         "bigN", ",", "bigN", ",", "bigN"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Jsamp", "[", "1", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Msamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Msamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Msamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Msamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Psamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Psamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Psamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Psamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "el"}], "-", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "nu1"}], "-", 
             RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "nu1"}], "-", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", "0"}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", " ", 
           RowBox[{"0", ",", 
            RowBox[{"nu1", "-", 
             RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nu1", "-", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", 
            RowBox[{"el", "-", 
             RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "el"}], "+", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "nu1"}], "+", 
             RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "nu1"}], "+", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", "0"}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", " ", 
           RowBox[{"0", ",", 
            RowBox[{"nu1", "+", 
             RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nu1", "+", 
             RowBox[{"I", "*", "\[Nu]"}]}], ",", 
            RowBox[{"el", "+", 
             RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "bigN", ",", "bigN", ",", "bigN", ",", "bigN", ",", "bigN", ",", 
         "bigN", ",", "bigN", ",", "bigN"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Jadapt", "[", "1", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Adapt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Jsamp", "[", "1", "]"}], "[", 
         RowBox[{"x", ",", "t"}], "]"}], ",", "globalTol"}], "]"}], "[", 
      RowBox[{
       RowBox[{"J", "[", "1", "]"}], "[", 
       RowBox[{"x", ",", "t"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Jadapt", "[", "1", "]"}], "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"J", "[", "1", "]"}], "[", 
       RowBox[{"x", ",", "t"}], "]"}]}], ";"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5406576785462*^9, 3.5406577161661997`*^9}, {
   3.5406582201982*^9, 3.5406582273082*^9}, 3.5406586749382*^9, 
   3.5407609243294*^9, {3.5408422052614202`*^9, 3.540842205632593*^9}, {
   3.540842429716239*^9, 3.540842429846467*^9}, {3.5409332732904*^9, 
   3.5409333148454*^9}, {3.541861619785755*^9, 3.541861623452838*^9}, {
   3.541861656327001*^9, 3.541861658902041*^9}, {3.5423735388424*^9, 
   3.5423735413424*^9}, {3.5424025499314003`*^9, 3.5424025521113997`*^9}, {
   3.5656156244642*^9, 3.5656156262852*^9}, {3.5656183001152*^9, 
   3.5656183043241997`*^9}, {3.5656205355512*^9, 3.5656205799202003`*^9}, {
   3.5656206584592*^9, 3.5656206776342*^9}, {3.5656208891191998`*^9, 
   3.5656208914672003`*^9}, {3.5656305467581997`*^9, 3.5656305490722*^9}, {
   3.5657106489052*^9, 3.5657106655822*^9}, {3.6688646030924935`*^9, 
   3.6688646086348104`*^9}, {3.6772627143488073`*^9, 3.677262720583387*^9}, {
   3.677608209671382*^9, 3.6776082151720424`*^9}, 3.6779991473028817`*^9, {
   3.677999184557966*^9, 3.67799918992822*^9}, {3.678001881442211*^9, 
   3.6780018874201045`*^9}, {3.678002011618438*^9, 3.678002025640688*^9}, {
   3.6783914930473757`*^9, 3.678391496735267*^9}, {3.68566798623199*^9, 
   3.6856681535216208`*^9}, {3.6859517281033816`*^9, 3.685951758126738*^9}, {
   3.6859783905449715`*^9, 3.6859784061135683`*^9}, {3.686288794679803*^9, 
   3.6862888619476275`*^9}, {3.6862891725226007`*^9, 
   3.6862891728504725`*^9}, {3.6864077369109006`*^9, 3.686407792555849*^9}, {
   3.6864089010727043`*^9, 3.6864089014266453`*^9}, {3.6864092530736113`*^9, 
   3.686409260567524*^9}, {3.6868004564582925`*^9, 3.686800502203461*^9}, {
   3.68680148632432*^9, 3.686801526310995*^9}, {3.688091337146123*^9, 
   3.6880913409543257`*^9}, {3.6894527277203636`*^9, 3.689452728519986*^9}, {
   3.6894527608570547`*^9, 3.689452769821656*^9}, {3.6894528252045593`*^9, 
   3.689452856125573*^9}, {3.689453022989581*^9, 3.6894530388147726`*^9}, {
   3.6894531054930983`*^9, 3.689453193812871*^9}, {3.689453905303151*^9, 
   3.6894539600585933`*^9}, 3.6894544257258134`*^9, {3.689899862992543*^9, 
   3.689899884135343*^9}, {3.6898999255974817`*^9, 3.689900131781048*^9}, 
   3.689900784742346*^9, {3.689900847493098*^9, 3.6899008581166725`*^9}, {
   3.689901006418699*^9, 3.689901009060914*^9}, {3.6899010563716145`*^9, 
   3.689901057652604*^9}, {3.6899636972342567`*^9, 3.6899637172647686`*^9}, {
   3.689964462000763*^9, 3.689964490496045*^9}, {3.6899661668188696`*^9, 
   3.689966182132007*^9}, {3.6899669618845563`*^9, 3.689966962837783*^9}, {
   3.690037667949239*^9, 3.690037673776153*^9}, {3.690038073264949*^9, 
   3.690038077609144*^9}, 3.6900381363874273`*^9, 3.6913645542617292`*^9, 
   3.692456546085143*^9, 3.6924573393977375`*^9, {3.6938593264344006`*^9, 
   3.693859333616865*^9}, {3.7005066082767935`*^9, 3.7005066161784353`*^9}, {
   3.7008549229877944`*^9, 3.700854923786682*^9}, 3.700855680694667*^9, {
   3.700855723095483*^9, 3.7008557601580796`*^9}, {3.700855792491417*^9, 
   3.700855895355403*^9}, {3.7008567548778605`*^9, 3.7008567573056507`*^9}, {
   3.7009323251397924`*^9, 3.7009323501262913`*^9}, {3.700939327773394*^9, 
   3.700939600695916*^9}, {3.700943493155965*^9, 3.7009435001724095`*^9}, {
   3.700945186369224*^9, 3.7009451990840645`*^9}, {3.701715892353188*^9, 
   3.701715915143448*^9}, {3.701720094865696*^9, 3.701720105283414*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Region 2: Outside the light cone, x<=-t   ( =X= shape deform with conjugation)\
\>", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.538443201592167*^9, 3.538443212095222*^9}, {
   3.5656156095022*^9, 3.5656156113522*^9}, 3.5656208942292*^9, {
   3.689900677555787*^9, 3.6899006862758226`*^9}, {3.6899008005683784`*^9, 
   3.689900839626792*^9}, 3.6899010108355513`*^9, 3.6899012719306927`*^9, {
   3.690038081875242*^9, 3.6900380998043575`*^9}, {3.7005064486353936`*^9, 
   3.700506491603101*^9}, 3.7005066215243626`*^9, {3.700849291251309*^9, 
   3.7008492938718653`*^9}, {3.7010191868313985`*^9, 3.701019198286107*^9}, {
   3.7010205380368724`*^9, 3.7010205652420263`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Modified", " ", "from", " ", 
    RowBox[{"NLS", ".", "nb"}], " ", "large", " ", "time"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DDI", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Im", "[", "k", "]"}], " ", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{
        RowBox[{"DD", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], ",", 
       RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"startift", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Clear", "[", "ift1", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ift1", ":=", 
         RowBox[{"ift1", "=", 
          RowBox[{"Fun", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "el"}], ",", 
               RowBox[{"-", "0.5"}]}], "}"}], "//", "Line"}], ",", "bigN"}], 
           "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", "ift2", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ift2", ":=", 
         RowBox[{"ift2", "=", 
          RowBox[{"Fun", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.5"}], ",", "0"}], "}"}], "//", "Line"}], ",", 
            "bigN"}], "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", "ift3", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ift3", ":=", 
         RowBox[{"ift3", "=", 
          RowBox[{"Fun", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0.5"}], "}"}], "//", "Line"}], ",", "bigN"}],
            "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", "ift4", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ift4", ":=", 
         RowBox[{"ift4", "=", 
          RowBox[{"Fun", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.5", ",", "el"}], "}"}], "//", "Line"}], ",", 
            "bigN"}], "]"}]}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}]}],
     ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "ift", " ", "here", " ", "is", " ", "not", " ", "inverse", " ", "Fourier",
      " ", "transform"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"startift", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"t5", "=", 
      RowBox[{"Timing", "[", 
       RowBox[{
        RowBox[{"ift1", "=", 
         RowBox[{"Fun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "el"}], ",", 
              RowBox[{"-", "0.5"}]}], "}"}], "//", "Line"}], ",", "bigN"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ift2", "=", 
         RowBox[{"Fun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.5"}], ",", "0"}], "}"}], "//", "Line"}], ",", 
           "bigN"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ift3", "=", 
         RowBox[{"Fun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0.5"}], "}"}], "//", "Line"}], ",", "bigN"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ift4", "=", 
         RowBox[{"Fun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.5", ",", "el"}], "}"}], "//", "Line"}], ",", "bigN"}],
           "]"}]}], ";"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Delta]t", "[", 
      RowBox[{"s_", ",", "k_"}], "]"}], ":=", 
     RowBox[{"Exp", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cauchy", "[", 
         RowBox[{"s", ",", "ift1", ",", "k"}], "]"}], "+", 
        RowBox[{"Cauchy", "[", 
         RowBox[{"s", ",", "ift2", ",", "k"}], "]"}], "+", 
        RowBox[{"Cauchy", "[", 
         RowBox[{"s", ",", "ift3", ",", "k"}], "]"}], "+", 
        RowBox[{"Cauchy", "[", 
         RowBox[{"s", ",", "ift4", ",", "k"}], "]"}]}], ")"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"s", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"+", "1"}], " ", "left", " ", "limit", " ", "of", " ", 
       "Cauchy", " ", "transform", " ", "s"}], "=", 
      RowBox[{
       RowBox[{"-", "1"}], " ", "right", " ", "limit", " ", "of", " ", 
       "Cauchy", " ", "transform"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Delta]t", "[", "k_", "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Delta]t", "[", "k", "]"}], "=", 
      RowBox[{"Exp", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cauchy", "[", 
          RowBox[{"ift1", ",", "k"}], "]"}], "+", 
         RowBox[{"Cauchy", "[", 
          RowBox[{"ift2", ",", "k"}], "]"}], "+", 
         RowBox[{"Cauchy", "[", 
          RowBox[{"ift3", ",", "k"}], "]"}], "+", 
         RowBox[{"Cauchy", "[", 
          RowBox[{"ift4", ",", "k"}], "]"}]}], ")"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalPhi]t", "[", "z__", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"\[Delta]t", "[", "z", "]"}], "0"},
        {"0", 
         FractionBox["1", 
          RowBox[{"\[Delta]t", "[", "z", "]"}]]}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalPhi]tin", "[", "z__", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"1", "/", 
          RowBox[{"\[Delta]t", "[", "z", "]"}]}], "0"},
        {"0", 
         RowBox[{"\[Delta]t", "[", "z", "]"}]}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"this", " ", "is", " ", "for", " ", "scaled", " ", "version"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]ts", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{
      RowBox[{"\[CapitalPhi]t", "[", 
       RowBox[{"x", ",", "t"}], "]"}], "[", 
      RowBox[{
       RowBox[{"z", "/", 
        RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
       RowBox[{"x", "/", 
        RowBox[{"(", 
         RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]tins", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{
      RowBox[{"\[CapitalPhi]tin", "[", 
       RowBox[{"x", ",", "t"}], "]"}], "[", 
      RowBox[{
       RowBox[{"z", "/", 
        RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
       RowBox[{"x", "/", 
        RowBox[{"(", 
         RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MaxRads", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", "*", 
          RowBox[{"Sqrt", "[", "t", "]"}]}], ",", "100"}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", "*", 
          RowBox[{
           RowBox[{"Sqrt", "[", "t", "]"}], "/", "2"}]}], ",", "1"}], "]"}]}],
       "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Using", " ", "Line"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nu1", "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"8", "\[Nu]"}], ")"}], "^", "2"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"8", "\[Nu]"}], ")"}]}], "-", "\[Nu]"}], ")"}], "^", 
        "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"J", "[", "2", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Jumps", ",", "Domains", ",", "NumPts"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Jumps", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalPhi]t", "[", "#", "]"}], ".", 
             RowBox[{
              RowBox[{"L", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
             RowBox[{"\[CapitalPhi]tin", "[", "#", "]"}]}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalPhi]t", "[", "#", "]"}], ".", 
             RowBox[{
              RowBox[{"L", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
             RowBox[{"\[CapitalPhi]tin", "[", "#", "]"}]}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalPhi]t", "[", "#", "]"}], ".", 
             RowBox[{
              RowBox[{"L", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
             RowBox[{"\[CapitalPhi]tin", "[", "#", "]"}]}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalPhi]t", "[", "#", "]"}], ".", 
             RowBox[{
              RowBox[{"L", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
             RowBox[{"\[CapitalPhi]tin", "[", "#", "]"}]}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalPhi]t", "[", "#", "]"}], ".", 
             RowBox[{
              RowBox[{"U", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
             RowBox[{"\[CapitalPhi]tin", "[", "#", "]"}]}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalPhi]t", "[", "#", "]"}], ".", 
             RowBox[{
              RowBox[{"U", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
             RowBox[{"\[CapitalPhi]tin", "[", "#", "]"}]}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalPhi]t", "[", "#", "]"}], ".", 
             RowBox[{
              RowBox[{"U", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
             RowBox[{"\[CapitalPhi]tin", "[", "#", "]"}]}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalPhi]t", "[", "#", "]"}], ".", 
             RowBox[{
              RowBox[{"U", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
             RowBox[{"\[CapitalPhi]tin", "[", "#", "]"}]}], "&"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Domains", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "el"}], "-", 
               RowBox[{"I", "*", "\[Nu]"}]}], ",", 
              RowBox[{
               RowBox[{"-", "nu1"}], "-", 
               RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "nu1"}], "-", 
               RowBox[{"I", "*", "\[Nu]"}]}], ",", "0"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", " ", 
             RowBox[{"0", ",", 
              RowBox[{"nu1", "-", 
               RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nu1", "-", 
               RowBox[{"I", "*", "\[Nu]"}]}], ",", 
              RowBox[{"el", "-", 
               RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "el"}], "+", 
               RowBox[{"I", "*", "\[Nu]"}]}], ",", 
              RowBox[{
               RowBox[{"-", "nu1"}], "+", 
               RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "nu1"}], "+", 
               RowBox[{"I", "*", "\[Nu]"}]}], ",", "0"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", " ", 
             RowBox[{"0", ",", 
              RowBox[{"nu1", "+", 
               RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nu1", "+", 
               RowBox[{"I", "*", "\[Nu]"}]}], ",", 
              RowBox[{"el", "+", 
               RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"NumPts", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"bigN", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Jumps", ",", "Domains", ",", "NumPts"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Jsamp", "[", "2", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Jumps", ",", "Domains", ",", "NumPts"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Jumps", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Lsamp", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Lsamp", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Lsamp", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Lsamp", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Usamp", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Usamp", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Usamp", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Usamp", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Domains", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "el"}], "-", 
               RowBox[{"I", "*", "\[Nu]"}]}], ",", 
              RowBox[{
               RowBox[{"-", "nu1"}], "-", 
               RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "nu1"}], "-", 
               RowBox[{"I", "*", "\[Nu]"}]}], ",", "0"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", " ", 
             RowBox[{"0", ",", 
              RowBox[{"nu1", "-", 
               RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nu1", "-", 
               RowBox[{"I", "*", "\[Nu]"}]}], ",", 
              RowBox[{"el", "-", 
               RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "el"}], "+", 
               RowBox[{"I", "*", "\[Nu]"}]}], ",", 
              RowBox[{
               RowBox[{"-", "nu1"}], "+", 
               RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "nu1"}], "+", 
               RowBox[{"I", "*", "\[Nu]"}]}], ",", "0"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", " ", 
             RowBox[{"0", ",", 
              RowBox[{"nu1", "+", 
               RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nu1", "+", 
               RowBox[{"I", "*", "\[Nu]"}]}], ",", 
              RowBox[{"el", "+", 
               RowBox[{"I", "*", "\[Nu]"}]}]}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"NumPts", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"bigN", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Jumps", ",", "Domains", ",", "NumPts"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7010463376861706`*^9, 3.7010463436050158`*^9}, {
   3.7010464041955867`*^9, 3.701046410389741*^9}, {3.701046513177369*^9, 
   3.701046535774499*^9}, {3.7010472335500755`*^9, 3.7010472494526515`*^9}, {
   3.701047475577806*^9, 3.701047476249775*^9}, {3.7010475502655096`*^9, 
   3.7010476111465807`*^9}, {3.7010476419363585`*^9, 3.701047734123063*^9}, {
   3.701047793100792*^9, 3.7010478315387*^9}, {3.701050880305873*^9, 
   3.7010509044406033`*^9}, {3.7010509576792965`*^9, 
   3.7010510215241365`*^9}, {3.70105153393138*^9, 3.7010515341814055`*^9}, {
   3.701083078828749*^9, 3.701083103823318*^9}, {3.7016564621444225`*^9, 
   3.701656465469533*^9}, {3.7016565016362314`*^9, 3.7016566018808155`*^9}, {
   3.701699171226449*^9, 3.7016991872324862`*^9}, 3.701700362856309*^9, {
   3.701700517627035*^9, 3.701700522997686*^9}, {3.70170169204814*^9, 
   3.70170170068437*^9}, {3.7017021520453215`*^9, 3.7017021612868185`*^9}, {
   3.7017028823282127`*^9, 3.7017029839381495`*^9}, {3.7017090064386606`*^9, 
   3.701709140296569*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Jadapt", "[", "2", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Adapt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Jsamp", "[", "2", "]"}], "[", 
       RowBox[{"x", ",", "t"}], "]"}], ",", "globalTol"}], "]"}], "[", 
    RowBox[{
     RowBox[{"J", "[", "2", "]"}], "[", 
     RowBox[{"x", ",", "t"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Jadapt", "[", "2", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"J", "[", "2", "]"}], "[", 
      RowBox[{"x", ",", "t"}], "]"}]}], ";"}], "*)"}], "1"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5406576785462*^9, 3.5406577161661997`*^9}, {
   3.5406582201982*^9, 3.5406582273082*^9}, 3.5406586749382*^9, 
   3.5407609243294*^9, {3.5408422052614202`*^9, 3.540842205632593*^9}, {
   3.540842429716239*^9, 3.540842429846467*^9}, {3.5409332732904*^9, 
   3.5409333148454*^9}, {3.541861619785755*^9, 3.541861623452838*^9}, {
   3.541861656327001*^9, 3.541861658902041*^9}, {3.5423735388424*^9, 
   3.5423735413424*^9}, {3.5424025499314003`*^9, 3.5424025521113997`*^9}, {
   3.5656156244642*^9, 3.5656156262852*^9}, {3.5656183001152*^9, 
   3.5656183043241997`*^9}, {3.5656205355512*^9, 3.5656205799202003`*^9}, {
   3.5656206584592*^9, 3.5656206776342*^9}, {3.5656208891191998`*^9, 
   3.5656208914672003`*^9}, {3.5656305467581997`*^9, 3.5656305490722*^9}, {
   3.5657106489052*^9, 3.5657106655822*^9}, {3.6688646030924935`*^9, 
   3.6688646086348104`*^9}, {3.6772627143488073`*^9, 3.677262720583387*^9}, {
   3.677608209671382*^9, 3.6776082151720424`*^9}, 3.6779991473028817`*^9, {
   3.677999184557966*^9, 3.67799918992822*^9}, {3.678001881442211*^9, 
   3.6780018874201045`*^9}, {3.678002011618438*^9, 3.678002025640688*^9}, {
   3.6783914930473757`*^9, 3.678391496735267*^9}, {3.68566798623199*^9, 
   3.6856681535216208`*^9}, {3.6859517281033816`*^9, 3.685951758126738*^9}, {
   3.6859783905449715`*^9, 3.6859784061135683`*^9}, {3.686288794679803*^9, 
   3.6862888619476275`*^9}, {3.6862891725226007`*^9, 
   3.6862891728504725`*^9}, {3.6864077369109006`*^9, 3.686407792555849*^9}, {
   3.6864089010727043`*^9, 3.6864089014266453`*^9}, {3.6864092530736113`*^9, 
   3.686409260567524*^9}, {3.6868004564582925`*^9, 3.686800502203461*^9}, {
   3.68680148632432*^9, 3.686801526310995*^9}, {3.688091337146123*^9, 
   3.6880913409543257`*^9}, {3.6894527277203636`*^9, 3.689452728519986*^9}, {
   3.6894527608570547`*^9, 3.689452769821656*^9}, {3.6894528252045593`*^9, 
   3.689452856125573*^9}, {3.689453022989581*^9, 3.6894530388147726`*^9}, {
   3.6894531054930983`*^9, 3.689453193812871*^9}, {3.689453905303151*^9, 
   3.6894539600585933`*^9}, 3.6894544257258134`*^9, {3.689899862992543*^9, 
   3.689899884135343*^9}, {3.6898999255974817`*^9, 3.689900131781048*^9}, 
   3.689900784742346*^9, {3.689900847493098*^9, 3.6899008581166725`*^9}, {
   3.689901006418699*^9, 3.689901009060914*^9}, {3.6899010563716145`*^9, 
   3.689901057652604*^9}, {3.6899636972342567`*^9, 3.6899637172647686`*^9}, {
   3.689964462000763*^9, 3.689964490496045*^9}, {3.6899661668188696`*^9, 
   3.689966182132007*^9}, {3.6899669618845563`*^9, 3.689966962837783*^9}, {
   3.690037667949239*^9, 3.690037673776153*^9}, {3.690038073264949*^9, 
   3.690038077609144*^9}, 3.6900381363874273`*^9, 3.6913645542617292`*^9, 
   3.692456546085143*^9, 3.6924573393977375`*^9, {3.6938593264344006`*^9, 
   3.693859333616865*^9}, {3.7005066082767935`*^9, 3.7005066161784353`*^9}, {
   3.7008549229877944`*^9, 3.700854923786682*^9}, 3.700855680694667*^9, {
   3.700855723095483*^9, 3.7008557601580796`*^9}, {3.700855792491417*^9, 
   3.700855895355403*^9}, {3.7008567548778605`*^9, 3.7008567573056507`*^9}, {
   3.7009323251397924`*^9, 3.7009323501262913`*^9}, {3.700939327773394*^9, 
   3.700939600695916*^9}, {3.700943493155965*^9, 3.7009435001724095`*^9}, {
   3.700945186369224*^9, 3.7009451990840645`*^9}, {3.7010205714954195`*^9, 
   3.701020591057808*^9}, {3.70104782897593*^9, 3.7010478466797757`*^9}, {
   3.701716227516469*^9, 3.7017162457978926`*^9}, {3.701720115590247*^9, 
   3.7017201243117948`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region 1: Small t (large x)", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5681287930307693`*^9, 3.5681287971735277`*^9}, {
  3.6688647754105444`*^9, 3.668864789481769*^9}, {3.677998938759244*^9, 
  3.677998939072046*^9}, {3.689901915091406*^9, 3.68990192433856*^9}}],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Modk0", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"t", " ", "<", " ", 
       RowBox[{"10", "*", "$MachineEpsilon"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sign", "[", "x", "]"}]}], "*", 
       RowBox[{"el", "/", "2"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sign", "[", "x", "]"}]}], "*", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"x", "/", 
           RowBox[{"(", 
            RowBox[{"4", "t"}], ")"}]}], "]"}], ",", 
         RowBox[{"el", "/", "2"}]}], "]"}]}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"initialization", " ", "cell", "   ", "and"}], "    ", "+", 
     RowBox[{
      RowBox[{"-", "modk0"}], " ", "in", " ", "small", " ", "time", " ", 
      "contour"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SmallTimeContour", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "el"}], " ", "+", " ", 
          RowBox[{"I", " ", "\[Nu]"}]}], ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "3", " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}]}], "}"}], "]"}], 
      RowBox[{"(*", 
       RowBox[{"U", " ", "part1"}], "*)"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "3", " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}], ",", "0"}], "}"}], "]"}], 
      RowBox[{"(*", 
       RowBox[{"U", " ", "part2"}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "el"}], ",", "0"}], "}"}], "]"}], 
      RowBox[{"(*", "D", "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "el"}], " ", "-", " ", 
          RowBox[{"I", " ", "\[Nu]"}]}], ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "5", " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}]}], "}"}], "]"}], 
      RowBox[{"(*", 
       RowBox[{"L", " ", "part1"}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "5", " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}], ",", "0"}], "}"}], "]"}], 
      RowBox[{"(*", 
       RowBox[{"L", " ", "part2"}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}]}], "}"}], "]"}], 
      RowBox[{"(*", 
       RowBox[{"p", " ", "part2"}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"I", " ", "\[Nu]"}], " ", "+", " ", "el"}]}], "}"}], "]"}], 
      
      RowBox[{"(*", 
       RowBox[{"p", " ", "part", " ", "1"}], " ", "*)"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}]}], "}"}], "]"}], 
      RowBox[{"(*", 
       RowBox[{"m", " ", "part2"}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "I"}], " ", "\[Nu]"}], " ", "+", " ", "el"}]}], "}"}],
        "]"}]}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{"m", " ", "part", " ", "1"}], " ", "*)"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "smallTimeContour", " ", "is", " ", "centered", " ", "at", 
     " ", "the", " ", "origin", " ", "right", " ", "now"}], "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"if", " ", "t", " ", "is", " ", "small"}], ",", " ", 
     RowBox[{"return", " ", "+", 
      RowBox[{
       RowBox[{"-", "100"}], "\[IndentingNewLine]", "  ", "if", " ", "t", " ",
        "is", " ", "large"}]}], ",", " ", 
     RowBox[{"return", " ", "smaller", " ", "one", " ", "of", " ", 
      RowBox[{"x", "/", "4"}], "t", " ", "and", " ", "100", 
      "\[IndentingNewLine]", "if", " ", "t", " ", "is", " ", "too", " ", 
      "small", " ", 
      RowBox[{"x", "/", "t"}], " ", "will", " ", "be", " ", "too", " ", "far",
       " ", "away", " ", "and", " ", "do", " ", "not", " ", "affect", " ", 
      "too", " ", "much"}], ",", " ", 
     RowBox[{
      RowBox[{
      "therefore", " ", "put", " ", "the", " ", "deformation", " ", "at", " ",
        "z"}], "=", 
      RowBox[{
       RowBox[{"+", 
        RowBox[{"-", "100"}]}], " ", "is", " ", "ok"}]}]}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"J", "[", "1", "]"}], "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DD", "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"L", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"L", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"M", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"M", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"SmallTimeContour", "[", 
        RowBox[{"x", ",", "t"}], "]"}], " ", "+", " ", 
       RowBox[{"Modk0", "[", 
        RowBox[{"x", ",", "t"}], "]"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
       "bigN", ",", "smallN", ",", "bigN", ",", "bigN", ",", "smallN", ",", 
        "smallN", ",", "bigN", ",", "smallN", ",", "bigN"}], "}"}]}], "}"}]}],
    ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Jsamp", "[", "1", "]"}], "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Usamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Usamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DDsamp", "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Lsamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Lsamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Psamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Psamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Msamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Msamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"SmallTimeContour", "[", 
        RowBox[{"x", ",", "t"}], "]"}], " ", "+", " ", 
       RowBox[{"Modk0", "[", 
        RowBox[{"x", ",", "t"}], "]"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
       "bigN", ",", "smallN", ",", "bigN", ",", "bigN", ",", "smallN", ",", 
        "smallN", ",", "bigN", ",", "smallN", ",", "bigN"}], "}"}]}], "}"}]}],
    ";", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"old", " ", "code", " ", "not", " ", "useful"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "seems", " ", "to", " ", "create", " ", "only", " ", "parts", " ", 
        "need", " ", "to", " ", "be", " ", "truncated", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Jsamp", "[", "1", "]"}], "[", 
         RowBox[{"x_", ",", "t_"}], "]"}]}], ":=", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"K0", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "]"}], "<", "\[Infinity]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Psamp", "[", 
                  RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"c1", "[", 
                   RowBox[{"x", ",", "t"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Msamp", "[", 
                  RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"c1", "[", 
                   RowBox[{"x", ",", "t"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"c1", "[", 
              RowBox[{"x", ",", "t"}], "]"}], ",", 
             RowBox[{
              RowBox[{"c1", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "//", "LineConjugate"}]}], 
            "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{"bigN", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"2", "*", 
                RowBox[{"Length", "[", 
                 RowBox[{"c1", "[", 
                  RowBox[{"x", ",", "t"}], "]"}], "]"}]}]}], "}"}]}], "]"}]}],
           "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Psamp", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Psamp", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Msamp", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Msamp", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "el"}], " ", ",", "0"}], "}"}], "+", 
               RowBox[{"I", " ", "\[Nu]"}]}], "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "el"}], "}"}], "+", 
               RowBox[{"I", " ", "\[Nu]"}]}], "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "el"}], " ", ",", "0"}], "}"}], "-", 
               RowBox[{"I", " ", "\[Nu]"}]}], "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", " ", ",", "el"}], "}"}], "-", 
               RowBox[{"I", " ", "\[Nu]"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"bigN", ",", "bigN", ",", "bigN", ",", "bigN"}], "}"}]}], 
          "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Jadapt", "[", "1", "]"}], "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Adapt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Jsamp", "[", "1", "]"}], "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", "globalTol"}], "]"}], "[", 
     RowBox[{
      RowBox[{"J", "[", "1", "]"}], "[", 
      RowBox[{"x", ",", "t"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "Try", " ", "to", " ", "break", " ", "the", " ", "contour", " ", "at", 
       " ", "z"}], "\[Equal]", 
      RowBox[{"0", "\[IndentingNewLine]", "SmallTimeContour"}]}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "el"}], " ", "+", " ", 
           RowBox[{"I", " ", "\[Nu]"}]}], ",", 
          RowBox[{
           RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", "3", " ", 
             RowBox[{"Pi", "/", "4"}]}], "]"}]}]}], "}"}], "]"}], 
       RowBox[{"(*", 
        RowBox[{"U", " ", "part1"}], "*)"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", "3", " ", 
             RowBox[{"Pi", "/", "4"}]}], "]"}]}], ",", "0"}], "}"}], "]"}], 
       RowBox[{"(*", 
        RowBox[{"U", " ", "part2"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "el"}], ",", "0"}], "}"}], "]"}], 
       RowBox[{"(*", "D", "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "el"}], " ", "-", " ", 
           RowBox[{"I", " ", "\[Nu]"}]}], ",", 
          RowBox[{
           RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", "5", " ", 
             RowBox[{"Pi", "/", "4"}]}], "]"}]}]}], "}"}], "]"}], 
       RowBox[{"(*", 
        RowBox[{"L", " ", "part1"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", "5", " ", 
             RowBox[{"Pi", "/", "4"}]}], "]"}]}], ",", "0"}], "}"}], "]"}], 
       RowBox[{"(*", 
        RowBox[{"L", " ", "part2"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", 
             RowBox[{"Pi", "/", "4"}]}], "]"}]}]}], "}"}], "]"}], 
       RowBox[{"(*", 
        RowBox[{"p", " ", "part2"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", 
             RowBox[{"Pi", "/", "4"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"I", " ", "\[Nu]"}], " ", "+", " ", "el"}]}], "}"}], "]"}], 
       RowBox[{"(*", 
        RowBox[{"p", " ", "part1"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"Pi", "/", "4"}]}], "]"}]}]}], "}"}], "]"}], 
       RowBox[{"(*", 
        RowBox[{"m", " ", "part2"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"Pi", "/", "4"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "I"}], " ", "\[Nu]"}], " ", "+", " ", "el"}]}], 
         "}"}], "]"}]}], "}"}]}], 
    RowBox[{"(*", 
     RowBox[{"m", " ", "part1"}], "*)"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "This", " ", "smallTimeContour", " ", "is", " ", "centered", " ", "at", 
      " ", "the", " ", "origin", " ", "right", " ", "now"}], "*)"}], " ", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Modk0", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"t", " ", "<", " ", 
        RowBox[{"10", "*", "$MachineEpsilon"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sign", "[", "x", "]"}]}], "*", 
        RowBox[{"el", "/", "2"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sign", "[", "x", "]"}]}], "*", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x", "/", 
            RowBox[{"(", 
             RowBox[{"4", "t"}], ")"}]}], "]"}], ",", 
          RowBox[{"el", "/", "2"}]}], "]"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"if", " ", "t", " ", "is", " ", "small"}], ",", " ", 
      RowBox[{"return", " ", "+", 
       RowBox[{
        RowBox[{"-", "100"}], "\[IndentingNewLine]", "  ", "if", " ", "t", 
        " ", "is", " ", "large"}]}], ",", " ", 
      RowBox[{"return", " ", "smaller", " ", "one", " ", "of", " ", 
       RowBox[{"x", "/", "4"}], "t", " ", "and", " ", "100", 
       "\[IndentingNewLine]", "if", " ", "t", " ", "is", " ", "too", " ", 
       "small", " ", 
       RowBox[{"x", "/", "t"}], " ", "will", " ", "be", " ", "too", " ", 
       "far", " ", "away", " ", "and", " ", "do", " ", "not", " ", "affect", 
       " ", "too", " ", "much"}], ",", " ", 
      RowBox[{
       RowBox[{
       "therefore", " ", "put", " ", "the", " ", "deformation", " ", "at", 
        " ", "z"}], "=", 
       RowBox[{
        RowBox[{"+", 
         RowBox[{"-", "100"}]}], " ", "is", " ", "ok"}]}]}], 
     "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"J", "[", "1", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"DD", "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"L", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"L", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
       ",", " ", 
       RowBox[{"SmallTimeContour", " ", "+", " ", 
        RowBox[{"Modk0", "[", 
         RowBox[{"x", ",", "t"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "bigN", ",", "smallN", ",", "bigN", ",", "bigN", ",", "smallN", ",", 
         "smallN", ",", "bigN", ",", "smallN", ",", "bigN"}], "}"}]}], 
      "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Jsamp", "[", "1", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Usamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Usamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"DDsamp", "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Lsamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Lsamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Psamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Psamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Msamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Msamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
       ",", " ", 
       RowBox[{"SmallTimeContour", " ", "+", " ", 
        RowBox[{"Modk0", "[", 
         RowBox[{"x", ",", "t"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "bigN", ",", "smallN", ",", "bigN", ",", "bigN", ",", "smallN", ",", 
         "smallN", ",", "bigN", ",", "smallN", ",", "bigN"}], "}"}]}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"old", " ", "code", " ", "not", " ", "useful"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "seems", " ", "to", " ", "create", " ", "only", " ", "parts", " ", 
         "need", " ", "to", " ", "be", " ", "truncated", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Jsamp", "[", "1", "]"}], "[", 
          RowBox[{"x_", ",", "t_"}], "]"}]}], ":=", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"K0", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "]"}], "<", "\[Infinity]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Psamp", "[", 
                   RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"c1", "[", 
                    RowBox[{"x", ",", "t"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Msamp", "[", 
                   RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"c1", "[", 
                    RowBox[{"x", ",", "t"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
              "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"c1", "[", 
               RowBox[{"x", ",", "t"}], "]"}], ",", 
              RowBox[{
               RowBox[{"c1", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "//", "LineConjugate"}]}], 
             "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{"bigN", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"2", "*", 
                 RowBox[{"Length", "[", 
                  RowBox[{"c1", "[", 
                   RowBox[{"x", ",", "t"}], "]"}], "]"}]}]}], "}"}]}], 
             "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Psamp", "[", 
                 RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
              
              RowBox[{
               RowBox[{
                RowBox[{"Psamp", "[", 
                 RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
              
              RowBox[{
               RowBox[{
                RowBox[{"Msamp", "[", 
                 RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
              
              RowBox[{
               RowBox[{
                RowBox[{"Msamp", "[", 
                 RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "el"}], " ", ",", "0"}], "}"}], "+", 
                RowBox[{"I", " ", "\[Nu]"}]}], "]"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "el"}], "}"}], "+", 
                RowBox[{"I", " ", "\[Nu]"}]}], "]"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "el"}], " ", ",", "0"}], "}"}], "-", 
                RowBox[{"I", " ", "\[Nu]"}]}], "]"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", " ", ",", "el"}], "}"}], "-", 
                RowBox[{"I", " ", "\[Nu]"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"bigN", ",", "bigN", ",", "bigN", ",", "bigN"}], "}"}]}],
            "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Jadapt", "[", "1", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Adapt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Jsamp", "[", "1", "]"}], "[", 
         RowBox[{"x", ",", "t"}], "]"}], ",", "globalTol"}], "]"}], "[", 
      RowBox[{
       RowBox[{"J", "[", "1", "]"}], "[", 
       RowBox[{"x", ",", "t"}], "]"}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.677947009615161*^9, 3.6779470230873003`*^9}, {
   3.6779470568468127`*^9, 3.677947093005432*^9}, {3.677947190927494*^9, 
   3.6779472257614665`*^9}, {3.6779472624039726`*^9, 
   3.6779473068450093`*^9}, {3.677947434505432*^9, 3.67794744489587*^9}, {
   3.677947599341999*^9, 3.6779476131667314`*^9}, {3.6779477170932918`*^9, 
   3.677947723796903*^9}, 3.6779665796439857`*^9, {3.6779962290902452`*^9, 
   3.6779962545459566`*^9}, {3.6779972153296633`*^9, 3.677997228317196*^9}, 
   3.677997415558151*^9, 3.67799747920743*^9, {3.678001527260233*^9, 
   3.6780015739954977`*^9}, {3.678001607933782*^9, 3.678001619144614*^9}, {
   3.6780021111581507`*^9, 3.678002115009404*^9}, {3.678002474541869*^9, 
   3.6780024787721195`*^9}, {3.6780026921867113`*^9, 3.678002715703257*^9}, {
   3.6783914990751343`*^9, 3.678391500153344*^9}, {3.6795999275233355`*^9, 
   3.679600012553198*^9}, {3.689901929208144*^9, 3.68990193842354*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Region 2: Large t", "Section",
 CellChangeTimes->{{3.5681287930307693`*^9, 3.5681287971735277`*^9}, {
  3.568140784197513*^9, 3.568140792715275*^9}, {3.5681424559224987`*^9, 
  3.568142457636324*^9}, {3.6688799689597454`*^9, 3.6688799723313513`*^9}, {
  3.668881515709519*^9, 3.6688815161151195`*^9}}],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DDI", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Im", "[", "k", "]"}], " ", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{
       RowBox[{"DD", "[", 
        RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], ",", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"startift", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", "ift", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ift", "[", "k0_", "]"}], ":=", 
        RowBox[{
         RowBox[{"ift", "[", "k0", "]"}], "=", 
         RowBox[{"Fun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"LeftEndpoint", "[", "dom", "]"}], ",", "k0"}], "}"}], "//",
             "Line"}], ",", "100"}], "]"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";", "\n", 
   RowBox[{"startift", "[", "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Delta]t", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", 
     RowBox[{"s_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cauchy", "[", 
       RowBox[{"s", ",", 
        RowBox[{"ift", "[", 
         RowBox[{
          RowBox[{"-", "x"}], "/", 
          RowBox[{"(", 
           RowBox[{"4", " ", "t"}], ")"}]}], "]"}], ",", "k"}], "]"}], "//", 
      "Exp"}], ")"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Delta]t", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cauchy", "[", 
       RowBox[{
        RowBox[{"ift", "[", 
         RowBox[{
          RowBox[{"-", "x"}], "/", 
          RowBox[{"(", 
           RowBox[{"4", " ", "t"}], ")"}]}], "]"}], ",", "k"}], "]"}], "//", 
      "Exp"}], ")"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalPhi]t", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "z__", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"\[Delta]t", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "0"},
       {"0", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"\[Delta]t", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]]}
      }], ")"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalPhi]tin", "[", "t__", "]"}], "[", "z__", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"1", "/", 
         RowBox[{
          RowBox[{"\[Delta]t", "[", "t", "]"}], "[", "z", "]"}]}], "0"},
       {"0", 
        RowBox[{
         RowBox[{"\[Delta]t", "[", "t", "]"}], "[", "z", "]"}]}
      }], ")"}]}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
    "t__", " ", "denotes", " ", "any", " ", "input", " ", "sequence"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalPhi]ts", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
    RowBox[{
     RowBox[{"\[CapitalPhi]t", "[", 
      RowBox[{"x", ",", "t"}], "]"}], "[", 
     RowBox[{
      RowBox[{"z", "/", 
       RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
      RowBox[{"x", "/", 
       RowBox[{"(", 
        RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalPhi]tins", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
    RowBox[{
     RowBox[{"\[CapitalPhi]tin", "[", 
      RowBox[{"x", ",", "t"}], "]"}], "[", 
     RowBox[{
      RowBox[{"z", "/", 
       RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
      RowBox[{"x", "/", 
       RowBox[{"(", 
        RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], ";", "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaxRads", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", "*", 
         RowBox[{"Sqrt", "[", "t", "]"}]}], ",", "100"}], "]"}], ",", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", "*", 
         RowBox[{
          RowBox[{"Sqrt", "[", "t", "]"}], "/", "2"}]}], ",", "1"}], "]"}]}], 
     "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"R2Jumps", " ", "=", " ", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]ts", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"L", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"\[CapitalPhi]tins", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]ts", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"L", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"\[CapitalPhi]tins", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]ts", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"\[CapitalPhi]tins", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]ts", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"\[CapitalPhi]tins", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]ts", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"M", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"\[CapitalPhi]tins", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]ts", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"M", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"\[CapitalPhi]tins", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]ts", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"\[CapitalPhi]tins", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]ts", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"\[CapitalPhi]tins", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DDI", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"\[CapitalPhi]tins", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DD", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"\[CapitalPhi]tins", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Lin", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"M", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"\[CapitalPhi]tins", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Lin", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
        RowBox[{
         RowBox[{"\[CapitalPhi]tins", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"R2Domains", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "el"}], " ", 
           RowBox[{"Sqrt", "[", "t", "]"}]}], " ", "-", " ", 
          RowBox[{"I", " ", "\[Nu]", " ", 
           RowBox[{"Sqrt", "[", "t", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"MaxRads", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "3"}], "I", " ", 
            RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"MaxRads", "[", 
         RowBox[{"x", ",", "t"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "I", " ", 
          RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "el"}], " ", 
           RowBox[{"Sqrt", "[", "t", "]"}]}], " ", "+", " ", 
          RowBox[{"I", " ", "\[Nu]", " ", 
           RowBox[{"Sqrt", "[", "t", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"MaxRads", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"3", "I", " ", 
            RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"MaxRads", "[", 
         RowBox[{"x", ",", "t"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"3", "I", " ", 
          RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"Reverse", "[", 
         RowBox[{"MaxRads", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "I"}], " ", 
          RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"MaxRads", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"el", " ", 
           RowBox[{"Sqrt", "[", "t", "]"}]}], " ", "-", " ", 
          RowBox[{"I", " ", "\[Nu]", " ", 
           RowBox[{"Sqrt", "[", "t", "]"}]}]}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"Reverse", "[", 
         RowBox[{"MaxRads", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", 
          RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"MaxRads", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", 
            RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"el", " ", 
           RowBox[{"Sqrt", "[", "t", "]"}]}], " ", "+", " ", 
          RowBox[{"I", " ", "\[Nu]", " ", 
           RowBox[{"Sqrt", "[", "t", "]"}]}]}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "3"}], "I", " ", 
            RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
          RowBox[{"Exp", "[", 
           RowBox[{"3", "I", " ", 
            RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "*", 
        RowBox[{
         RowBox[{"MaxRads", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"3", "I", " ", 
            RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", 
            RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "*", 
        RowBox[{
         RowBox[{"MaxRads", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", 
            RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", " ", "I"}], " ", 
            RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "*", 
        RowBox[{
         RowBox[{"MaxRads", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "3"}], " ", "I", " ", 
            RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "*", 
        RowBox[{
         RowBox[{"MaxRads", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"R2NumPts", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"smallN", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "12"}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R2NumPts", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "=", "bigN"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R2NumPts", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "=", "bigN"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R2NumPts", "[", 
     RowBox[{"[", "6", "]"}], "]"}], "=", "bigN"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R2NumPts", "[", 
     RowBox[{"[", "8", "]"}], "]"}], "=", "bigN"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"J", "[", "2", "]"}], "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
     "R2Jumps", ",", "\[IndentingNewLine]", "R2Domains", ",", 
      "\[IndentingNewLine]", "R2NumPts"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Jsamp", "[", "2", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Psamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Psamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Gsamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Psamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Psamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Msamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Msamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Msamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Msamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"c2", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{"smallN", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"c2", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Jadapt", "[", "2", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Adapt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Jsamp", "[", "2", "]"}], "[", 
         RowBox[{"x", ",", "t"}], "]"}], ",", "globalTol"}], "]"}], "[", 
      RowBox[{
       RowBox[{"J", "[", "2", "]"}], "[", 
       RowBox[{"x", ",", "t"}], "]"}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.6688799773423615`*^9, 3.6688800076028147`*^9}, {
   3.6688801577868824`*^9, 3.668880173045709*^9}, {3.668880204742366*^9, 
   3.6688803204031763`*^9}, {3.6688815194535255`*^9, 
   3.6688815253815355`*^9}, {3.6688821831931114`*^9, 3.668882217597573*^9}, {
   3.668882304230728*^9, 3.668882332837579*^9}, 3.668883783080772*^9, {
   3.6780021367522182`*^9, 3.6780021395737276`*^9}, {3.678391505437194*^9, 
   3.678391505984088*^9}, {3.689901945448747*^9, 3.689901954447223*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Soliton Contours (Use PFuns later)", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.540663327743*^9, 3.5406633359230003`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"InvScale", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Sqrt", "[", "t", "]"}], 
      RowBox[{"(", 
       RowBox[{"k", "+", 
        RowBox[{"x", "/", 
         RowBox[{"(", 
          RowBox[{"4", "t"}], ")"}]}]}], ")"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"+", "1"}], "]"}], "[", 
       RowBox[{"x_", ",", "t_", ",", "a_", ",", "c_"}], "]"}], "[", "z_", 
      "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {
         RowBox[{
          RowBox[{"-", "c"}], " ", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "a", "]"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"z", "-", "a"}], ")"}]}]}], "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"-", "1"}], "]"}], "[", 
       RowBox[{"x_", ",", "t_", ",", "a_", ",", "c_"}], "]"}], "[", "z_", 
      "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", 
         RowBox[{" ", 
          RowBox[{"cc", "[", 
           RowBox[{
            RowBox[{"-", "c"}], " ", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"\[Theta]", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "[", "a", "]"}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"cc", "[", "z", "]"}], "-", "a"}], ")"}]}]}], 
           "]"}]}]},
        {
         RowBox[{" ", "0"}], "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"+", "1"}], "]"}], "[", 
       RowBox[{"x_", ",", "t_", ",", "a_", ",", "c_"}], "]"}], "[", "z_", 
      "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", 
         RowBox[{
          FractionBox[
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"z", "-", "a"}], ")"}]}], "c"], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "a", "]"}]}], "]"}]}]},
        {"0", "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"-", "1"}], "]"}], "[", 
       RowBox[{"x_", ",", "t_", ",", "a_", ",", "c_"}], "]"}], "[", "z_", 
      "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {
         RowBox[{" ", 
          RowBox[{"cc", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"cc", "[", "z", "]"}], "-", "a"}], ")"}]}], "c"], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{
               RowBox[{"\[Theta]", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "[", "a", "]"}]}], "]"}]}], 
           "]"}]}], "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ContourArray", "[", 
      RowBox[{
       RowBox[{"+", "1"}], ",", "r_", ",", "a_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Arc", "[", 
        RowBox[{"a", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Pi"}], "}"}]}], "]"}], ",", 
       RowBox[{"Arc", "[", 
        RowBox[{"a", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"Pi", ",", 
           RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ContourArray", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "r_", ",", "a_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Arc", "[", 
        RowBox[{
         RowBox[{"a", "//", "cc"}], ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "Pi"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Arc", "[", 
        RowBox[{
         RowBox[{"a", "//", "cc"}], ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "Pi"}], ",", 
           RowBox[{
            RowBox[{"-", "2"}], "Pi"}]}], "}"}]}], "]"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.540663356863*^9, 3.5406634779230003`*^9}, {
   3.540663514553*^9, 3.540663559523*^9}, {3.5406636903546*^9, 
   3.5406638634946003`*^9}, {3.5406639640346003`*^9, 3.5406640204646*^9}, {
   3.5406641670945997`*^9, 3.5406641983646*^9}, {3.5406642496246*^9, 
   3.5406643193246*^9}, {3.5406643716646*^9, 3.5406643812946*^9}, {
   3.5406644820945997`*^9, 3.5406645177646*^9}, 3.5406645531018*^9, {
   3.5406646915018*^9, 3.5406648196538*^9}, {3.540668185589525*^9, 
   3.540668263873556*^9}, {3.54066831648492*^9, 3.5406684168554087`*^9}, {
   3.54066844904218*^9, 3.540668517764138*^9}, {3.540668618759264*^9, 
   3.540668717261815*^9}, {3.540669354468211*^9, 3.540669359280778*^9}, {
   3.540669502128993*^9, 3.5406695823656063`*^9}, {3.54066961440208*^9, 
   3.540669662983015*^9}, {3.54067189344142*^9, 3.540671925802581*^9}, {
   3.5406731652249823`*^9, 3.5406732638866568`*^9}, {3.5406741647813997`*^9, 
   3.5406741678613997`*^9}, {3.5406741991954*^9, 3.5406742011074*^9}, {
   3.5406826199754*^9, 3.5406826249944*^9}, {3.5406834491594*^9, 
   3.5406834534044*^9}, {3.5406835138184*^9, 3.5406835198314*^9}, {
   3.5406839573473997`*^9, 3.5406839578014*^9}, {3.5406875816144*^9, 
   3.5406875942444*^9}, {3.5406893661443996`*^9, 3.5406893835144*^9}, {
   3.5406894255744*^9, 3.5406894318104*^9}, {3.5407264300074*^9, 
   3.5407264358624*^9}, {3.540735266297641*^9, 3.54073530536005*^9}, {
   3.540735803202181*^9, 3.540735809259849*^9}, {3.540736099083493*^9, 
   3.540736100324586*^9}, {3.540737377234128*^9, 3.540737392702014*^9}, {
   3.540738683107176*^9, 3.540738743177516*^9}, {3.540738779460793*^9, 
   3.540738786570944*^9}, {3.540740941006283*^9, 3.540740955773658*^9}, {
   3.5407412010663157`*^9, 3.540741317799933*^9}, {3.5407610939393997`*^9, 
   3.5407612605094*^9}, {3.5407620108694*^9, 3.5407620122693996`*^9}, {
   3.5407621572894*^9, 3.5407621698494*^9}, {3.5407622649393997`*^9, 
   3.5407622724894*^9}, 3.5407625509994*^9, {3.5407640913234*^9, 
   3.5407640999234*^9}, {3.5407690321454*^9, 3.5407690325254*^9}, {
   3.5409028140464*^9, 3.5409028143864*^9}, {3.5656323663862*^9, 
   3.5656324283422003`*^9}, {3.5656324906851997`*^9, 
   3.5656325725522003`*^9}, {3.5656573568952*^9, 3.5656574370852003`*^9}, {
   3.5657050454421997`*^9, 3.5657051195582*^9}, {3.5657052135692*^9, 
   3.5657052213722*^9}, {3.5657053117812*^9, 3.5657053210292*^9}, {
   3.568131470694765*^9, 3.5681315057104*^9}, {3.6688853049176693`*^9, 
   3.6688853099159555`*^9}, {3.6868734243788137`*^9, 3.686873435717745*^9}, {
   3.6868761718716955`*^9, 3.6868761721998568`*^9}, 3.688170415005044*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"changed", " ", "PoleList", " ", "to", " ", "PoleListn"}], ",", 
    " ", 
    RowBox[{
    "cause", " ", "this", " ", "is", " ", "the", " ", "one", " ", "called", 
     " ", "in", " ", "the", " ", "Add", " ", "Poles", " ", "part"}]}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PoleListn", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"out", ",", "i", ",", "Domain", ",", "Jumps", ",", "Points"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Domain", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Jumps", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Points", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "a", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"why", " ", "do", " ", "we", " ", "need", " ", "upper", " ", 
           RowBox[{"bound", "?", " ", "or"}], " ", "even", " ", "the", " ", 
           "lower", " ", 
           RowBox[{"bound", ":", " ", "ans", ":", " ", 
            RowBox[{
            "to", " ", "cut", " ", "the", " ", "contour", " ", "off"}]}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "globalTol"}], ">", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"c", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], 
               RowBox[{"Exp", "[", 
                RowBox[{"Re", "[", 
                 RowBox[{
                  RowBox[{"\[Theta]", "[", 
                   RowBox[{"x", ",", "t"}], "]"}], "[", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}]}]}], "&&", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"c", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], 
               RowBox[{"Exp", "[", 
                RowBox[{"Re", "[", 
                 RowBox[{
                  RowBox[{"\[Theta]", "[", 
                   RowBox[{"x", ",", "t"}], "]"}], "[", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}]}], ">",
               " ", "globalTol"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"c", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], 
                 RowBox[{"Exp", "[", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"x", ",", "t"}], "]"}], "[", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
                ">", "expconst"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Jumps", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"Jumps", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Jumps", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"Jumps", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"flag", "=", "\"\<pos\>\""}], ";"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Jumps", " ", "=", " ", 
                 RowBox[{"Join", "[", 
                  RowBox[{"Jumps", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Jumps", " ", "=", " ", 
                 RowBox[{"Join", "[", 
                  RowBox[{"Jumps", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"flag", "=", "\"\<neg\>\""}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Domain", "=", " ", 
              RowBox[{"Join", "[", 
               RowBox[{"Domain", ",", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"ContourArray", "[", 
                   RowBox[{
                    RowBox[{"+", "1"}], ",", "rad", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"ContourArray", "[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "rad", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Points", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"Points", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "smallN", ",", "smallN", ",", "smallN", ",", "smallN"}], 
                 "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Jumps", ",", "Domain", ",", "Points"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.540663356863*^9, 3.5406634779230003`*^9}, {
   3.540663514553*^9, 3.540663559523*^9}, {3.5406636903546*^9, 
   3.5406638634946003`*^9}, {3.5406639640346003`*^9, 3.5406640204646*^9}, {
   3.5406641670945997`*^9, 3.5406641983646*^9}, {3.5406642496246*^9, 
   3.5406643193246*^9}, {3.5406643716646*^9, 3.5406643812946*^9}, {
   3.5406644820945997`*^9, 3.5406645177646*^9}, 3.5406645531018*^9, {
   3.5406646915018*^9, 3.5406648196538*^9}, {3.540668185589525*^9, 
   3.540668263873556*^9}, {3.54066831648492*^9, 3.5406684168554087`*^9}, {
   3.54066844904218*^9, 3.540668517764138*^9}, {3.540668618759264*^9, 
   3.540668717261815*^9}, {3.540669354468211*^9, 3.540669359280778*^9}, {
   3.540669502128993*^9, 3.5406695823656063`*^9}, {3.54066961440208*^9, 
   3.540669662983015*^9}, {3.54067189344142*^9, 3.540671925802581*^9}, {
   3.5406731652249823`*^9, 3.5406732638866568`*^9}, {3.5406741647813997`*^9, 
   3.5406741678613997`*^9}, {3.5406741991954*^9, 3.5406742011074*^9}, {
   3.5406826199754*^9, 3.5406826249944*^9}, {3.5406834491594*^9, 
   3.5406834534044*^9}, {3.5406835138184*^9, 3.5406835198314*^9}, {
   3.5406839573473997`*^9, 3.5406839578014*^9}, {3.5406875816144*^9, 
   3.5406875942444*^9}, {3.5406893661443996`*^9, 3.5406893835144*^9}, {
   3.5406894255744*^9, 3.5406894318104*^9}, {3.5407264300074*^9, 
   3.5407264358624*^9}, {3.540735266297641*^9, 3.54073530536005*^9}, {
   3.540735803202181*^9, 3.540735809259849*^9}, {3.540736099083493*^9, 
   3.540736100324586*^9}, {3.540737377234128*^9, 3.540737392702014*^9}, {
   3.540738683107176*^9, 3.540738743177516*^9}, {3.540738779460793*^9, 
   3.540738786570944*^9}, {3.540740941006283*^9, 3.540740955773658*^9}, {
   3.5407412010663157`*^9, 3.540741317799933*^9}, {3.5407610939393997`*^9, 
   3.5407612605094*^9}, {3.5407620108694*^9, 3.5407620122693996`*^9}, {
   3.5407621572894*^9, 3.5407621698494*^9}, {3.5407622649393997`*^9, 
   3.5407622724894*^9}, {3.5407625509994*^9, 3.5407625539294*^9}, 
   3.5407628404994*^9, {3.5407631811373997`*^9, 3.5407631847774*^9}, {
   3.5407638581274*^9, 3.5407638642874002`*^9}, {3.5407639867474003`*^9, 
   3.5407639944874*^9}, {3.5409021567874002`*^9, 3.5409021699004*^9}, {
   3.5409024156774*^9, 3.5409024266174*^9}, {3.5418962414278*^9, 
   3.5418962696868*^9}, {3.5656325796591997`*^9, 3.5656326739922*^9}, {
   3.5656408345022*^9, 3.5656408553482*^9}, {3.5656409296572*^9, 
   3.5656409311712*^9}, {3.5656410927402*^9, 3.5656410944161997`*^9}, {
   3.5656569424672003`*^9, 3.5656569628112*^9}, {3.5656570735601997`*^9, 
   3.5656570739122*^9}, {3.5656574485282*^9, 3.5656574568632*^9}, {
   3.5656575081242*^9, 3.5656575201902*^9}, 3.5657051296362*^9, {
   3.5657051636382*^9, 3.5657051928532*^9}, {3.5657052255741997`*^9, 
   3.5657052641122*^9}, {3.5657053266972*^9, 3.5657053442622004`*^9}, {
   3.5657055039852*^9, 3.5657056261212*^9}, {3.5657056569862003`*^9, 
   3.5657058077992*^9}, 3.5657058821342*^9, {3.5657059386932*^9, 
   3.5657060435632*^9}, {3.5657299619792*^9, 3.5657300165132*^9}, {
   3.5657300566001997`*^9, 3.5657300661042*^9}, {3.5657301133512*^9, 
   3.5657301772592*^9}, {3.5657304984102*^9, 3.5657305008901997`*^9}, {
   3.5657309373652*^9, 3.5657309378262*^9}, {3.5657310008402*^9, 
   3.5657310015192003`*^9}, {3.5657311318742*^9, 3.5657311407702*^9}, {
   3.5657311733612003`*^9, 3.5657311765502*^9}, {3.5657312242911997`*^9, 
   3.5657312298772*^9}, {3.5657312702562*^9, 3.5657312727232*^9}, {
   3.5657319452152*^9, 3.5657319568372*^9}, 3.5657319998802*^9, {
   3.5657320713552*^9, 3.5657321651472*^9}, 3.5657321965702*^9, {
   3.5657322322392*^9, 3.5657322623932*^9}, {3.5657325516442003`*^9, 
   3.5657325518982*^9}, {3.568131486325077*^9, 3.568131530817397*^9}, {
   3.677247035036838*^9, 3.67724708670691*^9}, {3.6886966142917433`*^9, 
   3.6886966234381027`*^9}, {3.688696662809819*^9, 3.6886967190113354`*^9}, {
   3.6886971283403015`*^9, 3.6886971384722815`*^9}, {3.6887031781740913`*^9, 
   3.688703187419688*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Add Poles and Choose", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5656330942762003`*^9, 3.5656330964582*^9}, {
  3.565800226807107*^9, 3.565800228918049*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DomainIntegrate", "[", "0.", "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tcrit", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SG", "[", "i_", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rhp1", ",", "rhp2", ",", "scale", ",", "\[CapitalPhi]1", ",", 
       "\[CapitalPhi]2", ",", "\[CapitalPhi]", ",", "out", ",", "t1", ",", 
       "t2", ",", "t3", ",", "t4", ",", "poles", ",", "pl"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "3"}], ",", 
        RowBox[{"scale", "=", "True"}], ",", 
        RowBox[{"scale", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"RHSolved", "//", "Clear"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RHSolved", "[", "X_", "]"}], ":=", 
       RowBox[{
        RowBox[{"RHSolved", "[", "X", "]"}], "=", 
        RowBox[{"RHSolve", "[", "X", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"RHSolution", "[", "X_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Cauchy", "[", 
         RowBox[{
          RowBox[{"X", "//", "RHSolved"}], ",", "z"}], "]"}], "+", 
        RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Q", " ", "is", " ", "V", " ", "in", " ", "the", " ", "book"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"scale", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Scaled", " ", "contour"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t1", "=", 
          RowBox[{"AbsoluteTiming", "[", 
           RowBox[{
            RowBox[{"rhp1", "=", 
             RowBox[{
              RowBox[{"ConjugateList", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Jadapt", "[", "i", "]"}], "[", 
                 RowBox[{"x", ",", "t"}], "]"}], ",", 
                RowBox[{"Q", "[", 
                 RowBox[{"x", ",", "t"}], "]"}]}], "]"}], "//", 
              "MakeListFun"}]}], ";"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"t2", "=", 
          RowBox[{"AbsoluteTiming", "[", 
           RowBox[{
            RowBox[{"RHSolved", "[", "rhp1", "]"}], ";"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalPhi]1", "[", "k_", "]"}], ":=", 
          RowBox[{
           RowBox[{
            RowBox[{"RHSolution", "[", "rhp1", "]"}], "[", 
            RowBox[{
             RowBox[{"InvScale", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "]"}], "//", 
           "Inverse"}]}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Unscaled", " ", "contour"}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<rhp1 unscaled constructing\>\"", "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t1", "=", 
          RowBox[{"Timing", "[", 
           RowBox[{
            RowBox[{"rhp1", "=", 
             RowBox[{
              RowBox[{"ConjugateList", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Jadapt", "[", "i", "]"}], "[", 
                 RowBox[{"x", ",", "t"}], "]"}], ",", 
                RowBox[{"Q", "[", 
                 RowBox[{"x", ",", "t"}], "]"}]}], "]"}], "//", 
              "MakeListFun"}]}], ";"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"domainOutput", " ", "=", " ", 
          RowBox[{"DomainPlot", "[", "rhp1", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Grhp1", "=", "rhp1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<rhp1 unscaled constructed\>\"", "]"}], 
           ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"t2", "=", 
          RowBox[{"Timing", "[", 
           RowBox[{
            RowBox[{"RHSolved", "[", "rhp1", "]"}], ";"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<rhp1 unscaled solved\>\"", "]"}], ";"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalPhi]1", "[", "k_", "]"}], ":=", 
          RowBox[{
           RowBox[{
            RowBox[{"RHSolution", "[", "rhp1", "]"}], "[", "k", "]"}], "//", 
           "Inverse"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", "k_", "]"}], ":=", 
       RowBox[{
        RowBox[{"RHSolution", "[", "rhp1", "]"}], "[", "k", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<rhp1 solved\>\"", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"pl", "=", 
       RowBox[{"PoleListn", "[", 
        RowBox[{"x", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "pl", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"t3", "=", 
       RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t4", "=", 
       RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"pl", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rhp2", "=", " ", 
          RowBox[{"ConjugateList", "[", 
           RowBox[{"pl", ",", 
            RowBox[{"Q", "[", 
             RowBox[{"x", ",", "t"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<checking polelist at x =\>\"", ",", "x", ",", 
             "\"\<, t =\>\"", ",", "t", ",", "\"\< and PoleListn[x,t]=\>\"", 
             ",", 
             RowBox[{"PoleListn", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "pl", " ", "is", " ", "not", " ", "given", " ", "any", " ", 
            "value"}], ",", " ", 
           RowBox[{
           "\[CapitalPhi]tin", " ", "is", " ", "the", " ", "delta", " ", "in",
             " ", "the", " ", "book"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rhp2", "=", " ", 
             RowBox[{"ConjugateList", "[", 
              RowBox[{"rhp2", ",", 
               RowBox[{"\[CapitalPhi]tin", "[", 
                RowBox[{"x", ",", "t"}], "]"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"t3", "=", 
          RowBox[{"Timing", "[", 
           RowBox[{
            RowBox[{"rhp2", "=", " ", 
             RowBox[{
              RowBox[{"ConjugateList", "[", 
               RowBox[{"rhp2", ",", "\[CapitalPhi]1"}], "]"}], "//", 
              "MakeListFun"}]}], ";"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Grhp2", "=", "rhp2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"t4", "=", 
          RowBox[{"Timing", "[", 
           RowBox[{
            RowBox[{"RHSolved", "[", "rhp2", "]"}], ";"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalPhi]2", " ", "=", " ", 
          RowBox[{"RHSolution", "[", "rhp2", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalPhi]", "[", "k_", "]"}], ":=", 
          RowBox[{
           RowBox[{
            RowBox[{"RHSolution", "[", "rhp2", "]"}], "[", "k", "]"}], ".", 
           RowBox[{
            RowBox[{"RHSolution", "[", "rhp1", "]"}], "[", "k", "]"}]}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"out", "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DomainIntegrate", "[", 
               RowBox[{"RHSolved", "[", "rhp1", "]"}], "]"}], "+", 
              RowBox[{"DomainIntegrate", "[", 
               RowBox[{"RHSolved", "[", "rhp2", "]"}], "]"}]}], ")"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "/", "Pi"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"out", "=", 
         RowBox[{
          RowBox[{"\[CapitalPhi]", "[", 
           RowBox[{"0.000000000001", "I"}], "]"}], ".", 
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "0", "]"}]}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"0.000000000001", "I"}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"\[CapitalPhi]", "[", 
          RowBox[{"0.000000000001", "I"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"domainOutput", " ", "=", " ", 
         RowBox[{
          RowBox[{"DomainPlot", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"rhp1", ",", "rhp2"}], "]"}], "]"}], "//", "Quiet"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"domainOutput2", " ", "=", " ", 
       RowBox[{
        RowBox[{"DomainPlot", "[", "rhp2", "]"}], "//", "Quiet"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"timestring", "=", " ", 
       RowBox[{"\"\<Region: \>\"", " ", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\< (\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"N", "[", "x", "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"N", "[", "t", "]"}], "]"}], "<>", "\"\<) \>\"", "<>", 
        "\"\<1) Construct: \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"t1", "//", "First"}], "]"}], "<>", "\"\<  \>\"", "<>", 
        "\"\<1) Solve: \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"t2", "//", "First"}], "]"}], "<>", "\"\<  \>\"", "<>", 
        "\"\<2) Construct: \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"t3", "//", "First"}], "]"}], "<>", "\"\<  \>\"", "<>", 
        "\"\<2) Solve: \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"t4", "//", "First"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"timeflag", ",", 
        RowBox[{
         RowBox[{"Print", "[", "timestring", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "out", ",", "\[CapitalPhi]", ",", "rhp1", ",", "rhp2", ",", 
        "timestring"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SGAuto", "[", 
   RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"SG", "[", "0", "]"}], "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", "x", "]"}], "<", 
         RowBox[{"Abs", "[", "t", "]"}]}]}], "}"}], 
      RowBox[{"(*", 
       RowBox[{"region", " ", "0"}], "*)"}], ",", "\[IndentingNewLine]", 
      "\t\t\t\t\t\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"SG", "[", "1", "]"}], "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"x", "\[GreaterEqual]", "t"}]}], " ", "}"}], 
      RowBox[{"(*", 
       RowBox[{"region", " ", "1"}], "*)"}], ",", "\[IndentingNewLine]", 
      "\t\t\t\t\t\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"SG", "[", "2", "]"}], "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"x", "\[LessEqual]", 
         RowBox[{"-", "t"}]}]}], " ", "}"}]}], "}"}], 
    RowBox[{"(*", 
     RowBox[{"region", " ", "2"}], "*)"}], ",", "\[IndentingNewLine]", 
    "\t\t\t\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"SG", "[", "0", "]"}], "[", 
      RowBox[{"x", ",", "t"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{"region", " ", "0"}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5656331021261997`*^9, 3.5656331507042*^9}, {
   3.5656332214231997`*^9, 3.5656332560642*^9}, {3.5656333681882*^9, 
   3.5656335261731997`*^9}, {3.5656335846042*^9, 3.5656335872632*^9}, {
   3.5656336435452003`*^9, 3.5656336860112*^9}, {3.5656338535052*^9, 
   3.5656338537632*^9}, {3.5656339276542*^9, 3.5656339286672*^9}, {
   3.5656592020192003`*^9, 3.5656592088892*^9}, {3.5656598958532*^9, 
   3.5656598966331997`*^9}, {3.5656619660292*^9, 3.5656620028492002`*^9}, 
   3.5656620931552*^9, {3.5656622786682*^9, 3.5656622915782003`*^9}, {
   3.5656634907882*^9, 3.5656635025982*^9}, {3.5656638034382*^9, 
   3.5656638245382*^9}, {3.5656644434452*^9, 3.5656644476521997`*^9}, {
   3.5656646513442*^9, 3.5656646589042*^9}, {3.5657047691472*^9, 
   3.5657047774302*^9}, {3.5657088696521997`*^9, 3.5657088700362*^9}, {
   3.5657089777462*^9, 3.5657090848772*^9}, {3.5657091151042*^9, 
   3.5657094998262*^9}, {3.5657095724021997`*^9, 3.5657095743862*^9}, {
   3.5657097344792*^9, 3.5657099280262003`*^9}, {3.5657109429972*^9, 
   3.5657110409142*^9}, {3.5657116229172*^9, 3.5657116266252003`*^9}, {
   3.5657271296342*^9, 3.5657272376172*^9}, {3.5657272685972*^9, 
   3.5657274588002*^9}, {3.5657275441552*^9, 3.5657275569462*^9}, {
   3.5657276169692*^9, 3.5657277268622*^9}, {3.5657277573022003`*^9, 
   3.5657277899292*^9}, {3.5657278648361998`*^9, 3.5657278652111998`*^9}, {
   3.5657279281822*^9, 3.5657280276302*^9}, 3.5657280680662003`*^9, {
   3.5657288935922003`*^9, 3.5657289195042*^9}, {3.5657303695222*^9, 
   3.5657304360642*^9}, {3.5657305933142*^9, 3.5657306444212*^9}, {
   3.565737475873736*^9, 3.5657374771709967`*^9}, {3.5657470873494787`*^9, 
   3.565747115534953*^9}, {3.5657549388660297`*^9, 3.565754942524865*^9}, {
   3.565754991522559*^9, 3.565754996829166*^9}, {3.5657555443336363`*^9, 
   3.5657555447033873`*^9}, {3.565797002050454*^9, 3.565797002546124*^9}, {
   3.5658025961582413`*^9, 3.565802605219771*^9}, {3.568127580519804*^9, 
   3.5681276101348543`*^9}, {3.568131542263668*^9, 3.5681315712070007`*^9}, {
   3.568131605785861*^9, 3.5681316949229507`*^9}, {3.568131732696384*^9, 
   3.568131740509767*^9}, {3.568322969266074*^9, 3.568323077591319*^9}, {
   3.568323294278069*^9, 3.5683233042625923`*^9}, {3.568324033184499*^9, 
   3.5683240550258636`*^9}, {3.56832940766568*^9, 3.5683294105702553`*^9}, {
   3.56833056230602*^9, 3.568330575438127*^9}, {3.568330607219866*^9, 
   3.568330632792687*^9}, {3.568330776498214*^9, 3.568330780459249*^9}, {
   3.568331372233078*^9, 3.568331390111599*^9}, {3.5683314338443937`*^9, 
   3.568331457094502*^9}, {3.568331527233041*^9, 3.568331543343507*^9}, {
   3.56833163003648*^9, 3.568331653829433*^9}, {3.56833310834986*^9, 
   3.5683331527307243`*^9}, {3.568333189641114*^9, 3.56833319117452*^9}, {
   3.56833482023983*^9, 3.568334820479849*^9}, {3.568336214323735*^9, 
   3.568336327812791*^9}, {3.568336368339611*^9, 3.568336389775852*^9}, {
   3.568336427292983*^9, 3.568336436168269*^9}, {3.568761150341702*^9, 
   3.568761161219804*^9}, {3.5687650065123873`*^9, 3.568765015534194*^9}, {
   3.568765082199418*^9, 3.568765083722076*^9}, {3.5687653061127043`*^9, 
   3.56876530626544*^9}, {3.568767025695422*^9, 3.568767027904599*^9}, {
   3.5687675619199553`*^9, 3.56876756635537*^9}, {3.5687759173177643`*^9, 
   3.5687759473891897`*^9}, {3.5687780314057283`*^9, 3.568778032566206*^9}, {
   3.6688836291712985`*^9, 3.6688836946344147`*^9}, {3.668883736736289*^9, 
   3.6688837441619024`*^9}, {3.6688838218682423`*^9, 3.668883822429843*^9}, {
   3.668885174048184*^9, 3.668885187405948*^9}, {3.668885338027563*^9, 
   3.668885376504764*^9}, {3.6688858031471663`*^9, 3.66888580653236*^9}, {
   3.6688858730821667`*^9, 3.668885873477189*^9}, {3.668885979057228*^9, 
   3.668885980655319*^9}, {3.6688860303591623`*^9, 3.6688860309741974`*^9}, 
   3.6689577614735537`*^9, {3.6701617772480497`*^9, 3.6701617775390663`*^9}, {
   3.6707659471643047`*^9, 3.6707659726077595`*^9}, {3.6761303725744133`*^9, 
   3.67613038853988*^9}, {3.6761307761257057`*^9, 3.676130790925072*^9}, {
   3.6761308612791605`*^9, 3.6761309709939585`*^9}, {3.6761328732254553`*^9, 
   3.676132890420184*^9}, {3.6761389826548657`*^9, 3.6761389915324945`*^9}, {
   3.676390849173929*^9, 3.67639092112669*^9}, {3.6763909871090326`*^9, 
   3.676391000906002*^9}, {3.676391044589841*^9, 3.6763910708977456`*^9}, {
   3.67639122363755*^9, 3.676391225393448*^9}, {3.6763917589933205`*^9, 
   3.676391808141592*^9}, {3.676392111961768*^9, 3.676392113610039*^9}, {
   3.6763922157251015`*^9, 3.6763922223382297`*^9}, {3.67639225895009*^9, 
   3.6763922664734774`*^9}, {3.676392302185066*^9, 3.6763923073795185`*^9}, {
   3.676392960528047*^9, 3.676392961115878*^9}, 3.6769995272828507`*^9, {
   3.6769997798976965`*^9, 3.676999787789686*^9}, {3.677246200490449*^9, 
   3.677246209563362*^9}, {3.6772465754542227`*^9, 3.6772466669199734`*^9}, {
   3.6772467226475306`*^9, 3.677246732398277*^9}, {3.6772467964270744`*^9, 
   3.677246814023486*^9}, {3.6772469272550707`*^9, 3.6772469289427176`*^9}, {
   3.677247275387919*^9, 3.6772472839230103`*^9}, {3.6772627353997917`*^9, 
   3.6772627666578913`*^9}, {3.6772628261140556`*^9, 3.677262842217844*^9}, 
   3.6772629666969085`*^9, {3.677265431686504*^9, 3.677265432635022*^9}, {
   3.6772682486519146`*^9, 3.6772682520680094`*^9}, {3.6772687936070147`*^9, 
   3.6772687950488453`*^9}, 3.677420916890621*^9, {3.677426998258724*^9, 
   3.6774270069638743`*^9}, {3.677427071170641*^9, 3.6774270837290344`*^9}, {
   3.6774281133767333`*^9, 3.677428133599532*^9}, {3.6778626316582804`*^9, 
   3.6778626511925216`*^9}, {3.68486395756957*^9, 3.6848639812806225`*^9}, 
   3.6848640227445173`*^9, {3.685106469211955*^9, 3.685106509342664*^9}, {
   3.685107353064272*^9, 3.685107370311141*^9}, {3.685108920045186*^9, 
   3.6851089239636*^9}, {3.685110446349871*^9, 3.6851104582856474`*^9}, {
   3.68594301477584*^9, 3.685943032809515*^9}, {3.6859431077160473`*^9, 
   3.685943111619728*^9}, {3.685943221969646*^9, 3.685943227542279*^9}, {
   3.6859433553876343`*^9, 3.685943357867729*^9}, {3.6859435869627542`*^9, 
   3.6859435908706627`*^9}, {3.6859437825173883`*^9, 
   3.6859437992936163`*^9}, {3.6859440687632184`*^9, 3.6859440699142013`*^9}, 
   3.6859475542503757`*^9, {3.6859483731162014`*^9, 3.6859483874815392`*^9}, {
   3.6859487421374435`*^9, 3.685948751704427*^9}, {3.685948788263733*^9, 
   3.6859487926444893`*^9}, {3.685952105890269*^9, 3.6859521071516743`*^9}, {
   3.685975356294606*^9, 3.6859753612010145`*^9}, {3.685976570383006*^9, 
   3.685976571673191*^9}, {3.6859784176637263`*^9, 3.685978421692875*^9}, {
   3.685978606118172*^9, 3.685978609907761*^9}, {3.686278636897105*^9, 
   3.6862786585577183`*^9}, {3.6862885883120995`*^9, 
   3.6862885916258993`*^9}, {3.686665123570956*^9, 3.6866651257458973`*^9}, 
   3.6866655707083206`*^9, {3.686667128812642*^9, 3.6866671472403045`*^9}, {
   3.6866671858189816`*^9, 3.686667189510654*^9}, 3.686667280160846*^9, {
   3.686667416434037*^9, 3.686667558113367*^9}, {3.686667842323572*^9, 
   3.6866678487686386`*^9}, {3.686667940890132*^9, 3.686667945057661*^9}, 
   3.686802559679226*^9, {3.6868026738527184`*^9, 3.6868026808350945`*^9}, 
   3.68680279891535*^9, {3.6868030109684114`*^9, 3.686803039431178*^9}, {
   3.686803111038266*^9, 3.686803121572008*^9}, 3.6868949875512805`*^9, {
   3.6880888277085257`*^9, 3.688088831943355*^9}, 3.688088920964346*^9, {
   3.6880901658639617`*^9, 3.688090176926589*^9}, {3.688091435522215*^9, 
   3.688091441562405*^9}, {3.68809149474555*^9, 3.688091497417715*^9}, {
   3.68809297952861*^9, 3.68809298813865*^9}, {3.6880932347601247`*^9, 
   3.688093242479704*^9}, {3.6880934968943114`*^9, 3.688093510346856*^9}, 
   3.6881379728852124`*^9, 3.6881383245441275`*^9, 3.6881760679708257`*^9, 
   3.688176463035537*^9, 3.688176703853044*^9, {3.688845191868128*^9, 
   3.688845205604705*^9}, {3.689900918131934*^9, 3.689900945512638*^9}, {
   3.689900990858239*^9, 3.689900991651428*^9}, {3.68990130522591*^9, 
   3.68990132953379*^9}, {3.6899568844857473`*^9, 3.6899568857046404`*^9}, {
   3.689963641145378*^9, 3.6899636412547617`*^9}, {3.690038144748347*^9, 
   3.690038147154887*^9}, {3.692470301179762*^9, 3.69247031120257*^9}, {
   3.69247078393194*^9, 3.6924707885068054`*^9}, {3.6924738356153016`*^9, 
   3.6924738594579377`*^9}, {3.6924738956848297`*^9, 3.6924739012260303`*^9}, 
   3.692475005148967*^9, 3.7005066413780274`*^9, {3.700506682851366*^9, 
   3.7005067235219355`*^9}, {3.700849308631929*^9, 3.7008493159447556`*^9}, {
   3.7010192398735905`*^9, 3.7010192615523567`*^9}, {3.7010479165686893`*^9, 
   3.7010479311634283`*^9}, {3.701048122886013*^9, 3.7010481784809585`*^9}, 
   3.7010491175217032`*^9, {3.7010492456407948`*^9, 3.701049400040687*^9}, {
   3.701701505024719*^9, 3.701701539244435*^9}, {3.701702209038951*^9, 
   3.7017022226584387`*^9}, 3.701703022334665*^9, {3.7017083344430313`*^9, 
   3.701708336552595*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finish", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5463644907164*^9, 3.5463644913004*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5463644931024*^9, 3.5463644945224*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{923, 1021},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
ShowSelection->True,
Magnification:>1.1 Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 571, 12, 73, "Input"],
Cell[CellGroupData[{
Cell[1153, 36, 125, 2, 78, "Section",
 InitializationGroup->True],
Cell[1281, 40, 11711, 197, 1653, "Input",
 InitializationGroup->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[13029, 242, 162, 3, 78, "Section",
 InitializationCell->True],
Cell[13194, 247, 13244, 304, 953, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[26475, 556, 179, 3, 78, "Section",
 InitializationCell->True],
Cell[26657, 561, 83835, 1980, 5333, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[110529, 2546, 224, 4, 78, "Section",
 InitializationGroup->True],
Cell[110756, 2552, 16796, 379, 1053, "Input",
 InitializationGroup->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[127589, 2936, 98, 1, 93, "Section"],
Cell[CellGroupData[{
Cell[127712, 2941, 186, 3, 63, "Subsection",
 InitializationCell->True],
Cell[127901, 2946, 21047, 575, 1930, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[148997, 3527, 348, 5, 93, "Section",
 InitializationCell->True],
Cell[149348, 3534, 5765, 141, 136, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[155150, 3680, 667, 9, 93, "Section",
 InitializationCell->True],
Cell[155820, 3691, 21332, 553, 838, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[177189, 4249, 698, 11, 150, "Section",
 InitializationCell->True],
Cell[177890, 4262, 21141, 559, 1993, "Input",
 InitializationCell->True],
Cell[199034, 4823, 4271, 73, 88, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[203342, 4901, 288, 4, 93, "Section",
 InitializationCell->True],
Cell[203633, 4907, 30092, 806, 2678, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[233762, 5718, 307, 4, 74, "Section"],
Cell[234072, 5724, 19779, 568, 1485, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[253888, 6297, 145, 2, 102, "Section",
 InitializationCell->True],
Cell[254036, 6301, 7204, 188, 330, "Input",
 InitializationCell->True],
Cell[261243, 6491, 12920, 264, 629, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[274200, 6760, 181, 3, 102, "Section",
 InitializationCell->True],
Cell[274384, 6765, 22300, 464, 1613, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[296721, 7234, 114, 2, 102, "Section",
 InitializationCell->True],
Cell[296838, 7238, 158, 4, 41, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

